//===== rAthena Script =======================================
//= Sarah and Fenrir
//===== Description: =========================================
//= [Walkthrough Conversion]
//= Sarah and Fenrir Instance
//===== Changelogs: ==========================================
//= 1.0 First version. [Capuche]
//============================================================
//= Translated en > ru [Akaineko] [Kellait]
//= Upgraded [Akaineko]
//============================================================


dali02,97,142,3	script	Профессор Бернхардт#a1	4_LGTSCIENCE,{
	if (BaseLevel < 145) {
		mes "- Вы не можете продолжать, пока не достигнете 145 уровня. -";
		close;
	}
	switch( checkquest(9336,PLAYTIME) ) {
	case -1:
		switch( isbegin_quest(9335) ) {
		case 0:// First time doing instance
			mes "[Профессор Бернхардт]";
            mes "Добрый день. Я профессор Бернхардт, лучший специалист по вооружению в Шварцвальде.";
            next;
            mes "[Профессор Бернхардт]";
            mes "На моём счету бесконечное количество исследований, однако я по-прежнему не удовлетворён результатами. В одном древнем тексте я нашёл упоминание так называемого пространственно-временного устройства.";
            next;
            mes "[Профессор Бернхардт]";
            mes "Кроме того, я понял, что при создании сверхмощного оружия не обойтись без артефактов славного прошлого.";
			next;
			mes "[Профессор Бернхардт]";
			if (getpartyleader(getcharid(1),2) != getcharid(0)) {
				mes "У меня есть один проект... Но для его осуществления мне необходимы определённые материалы.";
				mes "Это осколки так называемых ''Гигантов'', обьектов или существ, которые участвовали в битве между Сарой Ирен и Фенриром в далёком прошлом.";
				next;
				mes "[Профессор Бернхардт]";
				mes "Я не могу оставить поста, однако вы...";
				mes "Вы выглядите достаточно компетентно, чтобы просить вас об этом.";
				next;
				mes "[Профессор Бернхардт]";
				mes "Пожалуйста, пусть глава вашего отряда подойдёт ко мне, чтобы мы могли обсудить детали вашего назначения.";
				close;
			}
			mes "Мне нужен кто-то, кто сможет добыть осколки так называемых ''Гигантов''.";
			mes "Вы кажетесь мне подходящим кандидатом.";
			next;
			mes "[Профессор Бернхардт]";
			mes "Что скажете?";
			mes "Нужно будет переместиться в прошлое с помощью пространственно-временного устройства и добыть там осколки этих гигантов.";
			mes "Я лично прослежу, чтобы вы не остались без соответствующего вознаграждения. Берётесь?";
			next;
			if (select( "Нет.", "Да." ) == 1) {
				mes "[Профессор Бернхардт]";
				mes "Буду рад вас видеть, если вы измените своё решение.";
				close;
			}
			mes "[Профессор Бернхардт]";
			mes "Я настроил пространственно-временное устройство точно на то время, когда происходила битва между Сарой Ирен и Фенриром.";
			mes "Временное окно не резиновое, так что рекомендую поторопиться.";
			instance_create("Fenrir and Sarah");
			close;
		case 1:
			mes "[Профессор Бернхардт]";
            mes "Вам удалось добыть осколки? ";
            mes "Полагаю, вам пришлось столкнуться с неожиданностями. Я весьма благодарен вам за работу.";
            next;
            mes "[Профессор Бернхардт]";
            mes "Так как вам пришлось рисковать жизнью, чтобы добыть осколки, я не могу взять их просто так, не отплатив должным образом.";
			if (sarah_fenrir == 0) {
                mes "В качестве компенсации вы получите одну из прекрасно сохранившихся реликвий, найденных мной во время последней экспедиции.";
                next;
                mes "- Левая серьга Сары -";
                mes "Возможность Лечения ур. 1";
                mes "- Правая серьга Сары -";
                mes "Возможность Телепортации ур. 1";
                next;
                .@s = select( "Левая серьга Сары", "Правая серьга Сары" ) - 1;
			}
			mes "[Профессор Бернхардт]";
            mes "Пожалуйста, передайте осколки моему ведущему ассистенту. Я лично проконтролирую выдачу положенной вам награды, а так же процесс её усовершенствования путём зачарования.";
            next;
            mes "[Профессор Бернхардт]";
            mes "Чем больше осколков гигантов удастся собрать, тем лучше. Однако я не могу обеспечить бесперебойную поставку энергии для поддержания функционирования пространственно-временного устройства в непрерывном режиме.";
            next;
            mes "[Профессор Бернхардт]";
            mes "Пожалуйста, приходите через неделю, и я попрошу вас вновь помочь мне с добычей осколков.";
			erasequest 9335;// Search for shards of Gigantes
			setquest 9336;// Go back to Professor Bernhard
			if (isbegin_quest(9337) > 0)
				erasequest 9337;// Wrapping up the Adventure
			if (sarah_fenrir == 0) {
				sarah_fenrir = 1;
				getitem (28310+.@s),1;
			}
			close;
		case 2:
			end;
		}
	case 0:
	case 1:
		mes "[Профессор Бернхардт]";
        mes "В производстве сверхмощного вооружения мы используем так называемые ''осколки гигантов'', которые можно добыть только в прошлом. Однако на открытие окна требуется такое количество энергии, что пространственно-временное устройство может работать лишь ограниченное время. Пожалуйста, возвращайтесь через неделю, когда устройство аккумулирует достаточное количество энергии.";
		close;
	case 2:
		mes "[Профессор Бернхардт]";
		mes "Я вас ждал. ";
		mes "Как ваши успехи? ";
		mes "Пока вас небыло, удалось аккумулировать достаточно энергии. Мы можем снова запустить пространственно-временное устройство.";
		next;
		mes "[Профессор Бернхардт]";
		mes "Мои разрабоотки наконец-то сдвинулись с места! Но до их завершения ещё очень далеко, и нужно ещё много осколков тех самых гигантов.";
		next;
		mes "[Профессор Бернхардт]";
		mes "Так как я не могу оставить свой пост, мне опять понадобится помощь наёмника, сильного воина. Не желаете ли продолжить наше сотрудничество?";
		next;
		mes "[Профессор Бернхардт]";
		mes "О, похоже, подготовительные работы завершены. Не могли бы вы повторить экспедицию и добыть мне ещё осколков? Как и прежде, я лично проконтролирую, чтобы вы не остались без награды.";
		if (getpartyleader(getcharid(1),2) == getcharid(0)) {
			next;
			if (select( "Нет.", "Да." ) == 1) {
				mes "[Профессор Бернхардт]";
				mes "Пространственно-временное устройство настроено на момент битвы между Фенриром и Сарой. Окно не резиновое, поэтому советую поторопиться.";
				close;
			}
			instance_create("Fenrir and Sarah");
		}
		close;
	}
}

dali02,99,148,3	script	Устройство#XX1	PORTAL,{
	if (BaseLevel < 145) {
		mes "- Вы должны быть старше 145 уровня. -";
		close;
	}
	switch( checkquest(9336,PLAYTIME) ) {
	case -1:
		break;
	case 0:
	case 1:
		mes "- Пространственно-временное -";
		mes "- устройство неактивно. -";
		close;
	case 2:
		break;
	}
	if (isbegin_quest(9335) > 0) {
		mes "- Пространственно-временное -";
		mes "- устройство неактивно. -";
		close;
	}
	if (select( "Ничего не делать.", "Использовать устройство." ) == 1) {
		if (getcharid(1) > 0) {
			mes "- Кажется, эта штука что-то -";
			mes "- делает со временем. -";
			close;
		}
		mes "- Вы ощущаете какую-то сырость. -";
		close;
	}
	.@md_name$ = "Fenrir and Sarah";
	switch( instance_enter(.@md_name$) ) {
	case IE_OTHER:
		mes "Произошла неизвестная ошибка.";
		close;
	case IE_NOINSTANCE:
		mes "Воспоминания ''" + .@md_name$ + "'' не существует.";
		mes "Глава отряда сначала должен его создать.";
		close;
	case IE_NOMEMBER:
		mes "Только члены того отряда, который зарезервировал воспоминание, могу в него войти.";
		close;
	case IE_OK:
		mapannounce "dali02", strcharinfo(0) + ", член отряда " + getpartyname( getcharid(1) ) + ", вошёл в воспоминание ''Сара и Фенрир''.", bc_map,0xFF99,FW_NORMAL,12;
		setquest 9335;// Search for shards of Gigantes
		if (isbegin_quest(9336) > 0)
			erasequest 9336;
		// warp "1@glast",367,304;
		end;
	}
}

dali02,93,146,6	script	Ведущий ассистент#a1	4_M_REPAIR,{
	if (sarah_fenrir == 0) {// в оригинале тупо end; и никакого текста вообще [akaineko]
        mes "[Ведущий ассистент]";
        mes "Извините, на данный момент я занят.";
        close;
    }
	disable_items;
	mes "[Ведущий ассистент]";
	mes "Профессор упоминал о вас. Он приказал выдать вам существенную компенсацию за риски и успех.";
	next;
	switch( select( "Зачаровать.", "Получить.", "Закончить разговор." ) ) {
	case 1:
		mes "[Ведущий ассистент]";
		mes "Серьги Сары, найденные на месте раскопок, определённо имеют высокий потенциал.";
		next;
		switch( select( "Зачаровать серёжку.", "Очистить зачарование.", "Закончить разговор." ) ) {
		case 1:
			mes "[Ведущий ассистент]";
			mes "Эти украшения возможно зачаровать дважды. Какую именно серёжку вы хотите зачаровать?";
			next;
			switch( select( "Левую.", "Правую.", "Никакую!" ) ) {
			case 1:
				.@sarah_item_id = 28310;
				.@sarah_ring$ = "левая";
				break;
			case 2:
				.@sarah_item_id = 28311;
				.@sarah_ring$ = "правая";
				break;
			case 3:
				mes "[Ведущий ассистент]";
				mes "Если вы пожелаете зачаровать серьги Сары, обратитесь ко мне.";
				close;
			}
			mes "[Ведущий ассистент]";
			mes "Вам нужно будет надеть тот предмет, который подвергнется зачарованию. С какой стороны его искать?";
			next;
			if (select( "С левой стороны.", "С правой стороны." ) == 1) {
				.@part = EQI_ACC_L;
				.@column$ = "левая";
				.@bonus_size = 4;		// 4 possibilities
				.@bonus_chance = 20;	// 20% per possibility
			}
			else {
				.@part = EQI_ACC_R;
				.@column$ = "правая";
				.@bonus_size = 6;		// 6 possibilities
				.@bonus_chance = 10;	// 10% per possibility
			}
			.@equip_id = getequipid(.@part);
			if (.@equip_id != .@sarah_item_id) {
				mes "[Ведущий ассистент]";
				mes "Чтобы процесс зачарования стал возможен, " + .@sarah_ring$ + " серьга Сары должна быть надета с соответствующей стороны.";
				close;
			}
			setarray .@card[0], getequipcardid(.@part,0), getequipcardid(.@part,1), getequipcardid(.@part,2), getequipcardid(.@part,3);
			if (.@card[2] > 0) {// 2 enchants
				mes "[Ведущий ассистент]";
				mes "Этот предмет больше невозможно зачаровать. Его потенциал раскрыт полностью.";
				close;
			}
			if (.@card[3] > 0) {// 1 enchant
				mes "[Ведущий ассистент]";
				mes "Для данного артефакта возможно второе зачарование.";
				.@slot = 3;
			}
			else {// none enchant
				mes "[Ведущий ассистент]";
				mes "Данный артефакт не имеет зачарований.";
				.@slot = 4;
			}
			next;
			mes "[Ведущий ассистент]";
			mes "Какое именно зачарование вы хотите в слот " + .@slot + "?";
			next;
			switch( select( "Критический шанс / урон", "Мастер стрельбы / уворот", "Сохранение SP / МАТК", "Уменьшение задержки атаки / умений" ) ) {
			case 1:
				setarray .@bonus[0],
					4863,	// Fatal1
					4864,	// Fatal2
					4939,	// Critical2
					4940,	// Critical3
					4941,	// Critical4
					4865;	// Fatal3
				mes "[Ведущий ассистент]";
				mes "Вы выбрали зачарование типа ''Критический'' в слот " + .@slot + ".";
				break;
			case 2:
				setarray .@bonus[0],
					4832,	// Expert_Archer1
					4833,	// Expert_Archer2
					4942,	// Dodge1
					4943,	// Dodge2
					4944,	// Dodge3
					4834;	// Expert_Archer3
				mes "[Ведущий ассистент]";
				mes "Вы выбрали зачарование типа ''Мастер стрельбы / уворот'' в слот " + .@slot + ".";
				break;
			case 3:
				setarray .@bonus[0],
					4945,	// Thrift1
					4946,	// Thrift2
					4897,	// Matk3p
					4898,	// Matk4p
					4947,	// Thrift3
					4899;	// Matk5p
				mes "[Ведущий ассистент]";
				mes "Вы выбрали зачарование типа ''Сила разума'' в слот " + .@slot + ".";
				break;
			case 4:
				setarray .@bonus[0],
					4869,	// Attack_Delay_1
					4872,	// Attack_Delay_2
					4948,	// Skill_Delay1
					4949,	// Skill_Delay2
					4950,	// Skill_Delay3
					4873;	// Attack_Delay_3
				mes "[Ведущий ассистент]";
				mes "Вы выбрали зачарование типа ''Уменьшение задержки атаки / умений'' в слот " + .@slot + ".";
				break;
			}
			next;
			mes "[Ведущий ассистент]";
			mes "Для каждого зачарования требуется 4 осколка гигантов.";
			next;
			mes "[Ведущий ассистент]";
			mes "Так как в процессе есть шанс безвозвратно испортить предмет, я должен убедиться: вы готовы к зачарованию?";
			next;
			if (select( "Нет.", "Да." ) == 1) {
				mes "[Ведущий ассистент]";
				mes "Обратитесь ко мне, когда примете однозначное решение.";
				close;
			}
			if (countitem(6803) < 4) {
				mes "[Ведущий ассистент]";
				mes "К сожалению, этого количества осколков недостаточно. Нужно не менее четырёх (4) осколков.";
				close;
			}
			mes "[Ведущий ассистент]";
			mes "Хорошо. Начинаем! ";
			mes "Желаю вам удачи!";
			next;
			mes "[Ведущий ассистент]";
			mes "Итак...";
			next;
			progressbar "000000",5;
			specialeffect2 EF_MAGICALATTHIT;
			specialeffect2 EF_POTION2;
			delitem 6803,4;// Shard of Gigantes

			// anti-hack
			if (callfunc("F_IsEquipIDHack", .@part, .@equip_id) || callfunc("F_IsEquipCardHack", .@part, .@card[0], .@card[1], .@card[2], .@card[3]))
				close;

			delequip .@part;
			.@r = rand(100);
			for ( .@i = 0; .@i < .@bonus_size && (.@bonus_chance * (.@i+1)) < .@r; .@i++ );
			if (.@i == .@bonus_size) {
				specialeffect2 EF_CRASHEARTH;
				specialeffect2 EF_MAXPOWER;
				mes "[Ведущий ассистент]";
				mes "К сожалению... Это провал. ";
				mes "Предмет невосстановим. ";
				mes "";
				mes "Увы...";
				close;
			}
			.@card[.@slot-1] = .@bonus[.@i];
			specialeffect2 EF_ANGEL2;
			getitem2 .@sarah_item_id,1,1,0,0,.@card[0],.@card[1],.@card[2],.@card[3];
			mes "[Ведущий ассистент]";
			mes "Зачарование завершено!";
			close;
		case 2:
			mes "[Ведущий ассистент]";
			mes "Что именно вы хотите отправить на очистку?";
			next;
			switch( select( "Левую серёжку Сары.", "Правую серёжку Сары.", "Ничего." ) ) {
			case 1:
				.@sarah_item_id = 28310;
				.@sarah_ring$ = "левая";
				break;
			case 2:
				.@sarah_item_id = 28311;
				.@sarah_ring$ = "правая";
				break;
			case 3:
				mes "[Ведущий ассистент]";
				mes "Если передумаете, обратитесь ко мне.";
				close;
			}
			mes "[Ведущий ассистент]";
			mes "Для этого потребуется 1 осколок гигантов...";
			next;
			if (countitem(6803) < 1) {
				mes "[Ведущий ассистент]";
				mes "Эх... ";
				mes "Простите, наверное, я невнятно выразился: необходим один осколок гигантов.";
				close;
			}
			mes "[Ведущий ассистент]";
			mes "Вам нужно будет надеть тот предмет, который подвергнется очищению. ";
			mes "С какой стороны его искать?";
			next;
			if (select( "Слева.", "Справа." ) == 1) {
				.@part = EQI_ACC_L;
				.@column$ = "левая";
			}
			else {
				.@part = EQI_ACC_R;
				.@column$ = "правая";
			}
			.@equip_id = getequipid(.@part);
			setarray .@card[0], getequipcardid(.@part,0), getequipcardid(.@part,1), getequipcardid(.@part,2), getequipcardid(.@part,3);
			if (.@equip_id == -1) {
				mes "[Ведущий ассистент]";
				mes "Вам следует надеть предмет, который подвергнется очищению, с соответствующей стороны.";
				close;
			}
			if (.@equip_id != .@sarah_item_id) {
				mes "[Ведущий ассистент]";
				mes "Пожалуйста, наденьте предмет, который подвергнется очищению, с соответствующей стороны.";
				close;
			}
			if (getequipcardid(.@part,3) < 1) {
				mes "[Ведущий ассистент]";
				mes "Предметы без зачарований невозможно от них очистить.";
				close;
			}
			mes "[Ведущий ассистент]";
			mes "Вами выбрана " + .@sarah_ring$ + " серьга Сары, " + .@column$ + " сторона.";
			mes "Я должен напомнить, что после очистки все зачарования будут невосстановимы. ";
			mes "Это то, что вам нужно?";
			next;
			if (select( "Нет.", "Да." ) == 2) {
				mes "[Ведущий ассистент]";
				mes "Так точно. Начинаем.";
				next;
				progressbar "000000",5;
				specialeffect2 EF_MAGICALATTHIT;
				specialeffect2 EF_POTION2;
				specialeffect2 EF_ANGEL2;
				delitem 6803,1;// Shard of Gigantes

				// anti-hack
				if (callfunc("F_IsEquipIDHack", .@part, .@equip_id) || callfunc("F_IsEquipCardHack", .@part, .@card[0], .@card[1], .@card[2], .@card[3]))
					close;

				delequip .@part;
				getitem .@sarah_item_id,1;
				mes "[Ведущий ассистент]";
				mes "Очистка завершена.";
				mes "Обращайтесь, если вам ещё раз потребуется моя помощь.";
			}
			close;
		case 3:
			mes "[Ведущий ассистент]";
			mes "Обращайтесь.";
			close;
		}
	case 2:
		mes "[Ведущий ассистент]";
		mes "Эти предметы найдены на раскопках во время предпринятой профессором Бернхардтом экспедиции и, несомненно, связаны с прошлым Гластхейма.";
		next;
		mes "[Ведущий ассистент]";
		mes "Мы предполагаем, что эти серьги носила сама Сара Ирен. Они обладают большой силой, и их потенциал раскрыт не до конца.";
		next;
		mes "[Ведущий ассистент]";
		mes "За один осколок я могу выдать вам одну из них.";
		next;
		mes "[Ведущий ассистент]";
		mes "- Левая серьга Сары -";
		mes "Возможность Лечения 1 ур.";
		mes "- Правая серьга Сары -";
		mes "Возможность Телепортации 1 ур.";
		mes "-----------------------";
		mes "Какую вы хотите?";
		next;
		.@s = select( "Левую.", "Правую.", "Закончить разговор." ) - 1;
		if (.@s < 2) {
			if (countitem(6803) < 1) {
				mes "[Ведущий ассистент]";
				mes "Этого количества осколков недостаточно. ";
				mes "Прошу прощения, но у меня приказ -- я ничего не могу поделать.";
				close;
			}
			delitem 6803,1;// Shard of Gigantes
			getitem (28310+.@s),1;
		}
		mes "[Ведущий ассистент]";
		mes "Профессор Бернхардт для меня очень много значит. Я его очень уважаю. Есть ли у вас кто-то, кого вы уважаете настолько же?";
		close;
	case 3:
		mes "[Ведущий ассистент]";
		mes "Профессор упоминал о вас. Он приказал выдать вам существенную компенсацию за риски и успех.";
		close;
	}
}

1@glast,360,295,0	script	#glast_event_1	HIDDEN_WARP_NPC,8,8,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_1");
	mes "";
	specialeffect2 EF_HIT2;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Хм? Здесь кто-то есть? Приветствую~ Вы, должно быть, путешественник?";
	sleep2 3000;
	cutin "fenrir_a.bmp",2;
	npctalk "Фенрир: Странно... Не припоминаю, чтобы Гластхейм был наполнен таким сильным злом...", 'fenrir_1$;
	sleep2 3000;
	npctalk "Фенрир: Нет времени на церемонии. Не теряй бдительности. Похоже, кто-то здесь призвал чудовище!", 'fenrir_1$;
	sleep2 3000;
	cutin "",255;
	specialeffect EF_LOCKON, AREA, 'fenrir_1$;
	.@label$ = instance_npcname("#glast_event_1") + "::OnMobDead";
	monster 'map_glast$,355,300, "Галион-мутант",3198,1, .@label$;	// MM_M_GALION
	monster 'map_glast$,358,300, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,361,300, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,355,289, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,358,289, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,364,294, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,364,297, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,364,291, "Галион-мутант",3198,1, .@label$;
	monster 'map_glast$,353,290, "Галион-мутант",3198,1, .@label$;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Что это за... твари?";
	npctalk "Фенрир: Дай мне немного времени на сотворение заклинания. Я с ними разберусь!", 'fenrir_1$;
	donpcevent instance_npcname("#glast_event_1") + "::OnBar";
	donpcevent instance_npcname("#glast_event_1") + "::OnEvent";
	end;
OnBar:
	progressbar_npc "000000",10, 'fenrir_1$;
	end;

OnEvent:
	// npctalk "Фенрир: Дай мне немного времени на сотворение заклинания. Я с ними разберусь!", 'fenrir_1$;// double on official
	sleep 3000;
	npctalk "Фенрир: Неба праведный гнев.", 'fenrir_1$;
	sleep 3000;
	npctalk "Фенрир: Гром, что землю расколет!", 'fenrir_1$;
	sleep 3000;
	npctalk "Фенрир: Предо мною пади!", 'fenrir_1$;
	sleep 3000;
	npctalk "Фенрир: Хэээй! Гррром и молния!!!", 'fenrir_1$;
	for ( .@i = 1; .@i < 8; .@i++ )
		specialeffect EF_THUNDERSTORM, AREA, instance_npcname( "#effect_glast_event01_" + .@i );
	killmonster 'map_glast$, instance_npcname("#glast_event_1") + "::OnMobDead";
	sleep 4000;
	npctalk "Фенрир: Гластхейм, бывший когда-то собором самих богов Асгарда...", 'fenrir_1$;
	sleep 3000;
	npctalk "Фенрир: Ныне во власти чудовищ...", 'fenrir_1$;
	sleep 3000;
	npctalk "Фенрир: Стой... Здесь что-то не так...", 'fenrir_1$;
	sleep 3000;
	npctalk "Фенрир: Здесь обитают галионы...", 'fenrir_1$;
	sleep 3000;
	enablenpc instance_npcname("#glast_event_3");
	end;

OnMobDead:
	end;
}

1@glast,360,295,0	script	#glast_event_3	HIDDEN_WARP_NPC,8,8,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_3");
	mes "";
	cutin "fenrir_a.bmp",2;
	npctalk "Фенрир: Да, знаю, что это было неожиданно, но спасибо за помощь.", 'fenrir_1$;
	sleep2 2000;
	npctalk "Фенрир: Кто ты?", 'fenrir_1$;
	sleep2 2000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : А... Да я...";
	sleep2 2000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : ...Я простой путешественник!";
	sleep2 2000;
	npctalk "Фенрир: Правда?.. Ясно. Это не имеет значения.", 'fenrir_1$;
	sleep2 2000;
	npctalk "Фенрир: Это место, похоже, отнюдь не безопасно. Ещё не поздно повернуть назад.", 'fenrir_1$;
	sleep2 2000;
	npctalk "Фенрир: Я ищу один предмет. И мне нужно спешить.", 'fenrir_1$;
	sleep2 2000;
	npctalk "Фенрир: Возможно, ты можешь мне помочь...", 'fenrir_1$;
	sleep2 2000;
	npctalk "Фенрир: Хотя нет. В любом случае благодарю тебя. Надеюсь, мы увидимся вновь!", 'fenrir_1$;
	sleep2 3000;
	cutin "",255;
	specialeffect EF_LOCKON, AREA, 'fenrir_1$;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Это, что... был... реально Фенрир? Враг богов и всё такое?.. Да нет... Наверняка нет.";

	disablenpc 'fenrir_1$;
	for ( .@i = 1; .@i < 8; .@i++ )
		disablenpc instance_npcname("#effect_glast_event01_" + .@i);
	enablenpc instance_npcname("#glast_move_01");
	enablenpc instance_npcname("#glast_event_5");
	enablenpc 'fenrir_2$;
	end;
}

1@glast,359,296,4	script	#effect_glast_event01_1	CLEAR_NPC,{ end; }
1@glast,353,294,4	duplicate(#effect_glast_event01_1)	#effect_glast_event01_2	CLEAR_NPC
1@glast,360,304,4	duplicate(#effect_glast_event01_1)	#effect_glast_event01_3	CLEAR_NPC
1@glast,366,295,4	duplicate(#effect_glast_event01_1)	#effect_glast_event01_4	CLEAR_NPC
1@glast,352,304,4	duplicate(#effect_glast_event01_1)	#effect_glast_event01_5	CLEAR_NPC
1@glast,356,284,4	duplicate(#effect_glast_event01_1)	#effect_glast_event01_6	CLEAR_NPC
1@glast,345,283,4	duplicate(#effect_glast_event01_1)	#effect_glast_event01_7	CLEAR_NPC

1@glast,359,294,4	duplicate(#effect_glast_event01_1)	Фенрир#glast_01	4_F_FENRIR

// Warps
// From entrance
1@glast,352,279,0	script	#glast_move_01	WARPNPC,4,4,{
	end;
OnTouch:
	if ('back_to_entrance == 0)
		warp 'map_glast$,347,265;
	else {
		disablenpc instance_npcname("#glast_move_01");
		initnpctimer;
	}
	end;

OnTimer1500:
	specialeffect EF_FIREPILLARON2, AREA, 'sarah_ego$;
	end;
OnTimer2000:
	hideoffnpc 'sarah_ego$;
	specialeffect EF_WHITEBODY, AREA, 'sarah_ego$;
	end;
OnTimer3000:
	npctalk "Сара Ирен: Впечатляет, Фенрир. Тебя непросто поймать.", 'sarah_ego$;
	end;
OnTimer7500:
	npctalk "Сара Ирен: Сегодня я заставлю тебя отступить.", 'sarah_ego$;
	end;
OnTimer8000:
	npctalk "Фенрир: Сегодня я разрушу роковые узы между нами.", 'fenrir_11$;
	end;
OnTimer11000:
	npctalk "Сара Ирен: Однако не думай, что это конец!", 'sarah_ego$;
	end;
OnTimer14000:
	npctalk "Сара Ирен: Мы обязательно увидимся вновь!!!", 'sarah_ego$;
	end;
OnTimer14500:
	npctalk "Фенрир: Мм... Я с нетерпением буду ждать нашей встречи... Сара Ирен.", 'fenrir_11$;
	specialeffect EF_FIREPILLARON2, AREA, 'sarah_ego$;
	end;
OnTimer15500:
	stopnpctimer;
	disablenpc 'sarah_ego$;
	end;
}

// Fenrir left side
// 1@glast,42,350,0	warp2	#glast_event_warp_1	10,10,1@glast,105,369
// 1@glast,52,346,0	warp2	#glast_event_warp_2	10,10,1@glast,105,369
// 1@glast,35,364,0	warp2	#glast_event_warp_3	10,10,1@glast,105,369
// 1@glast,41,364,0	warp2	#glast_event_warp_4	10,10,1@glast,105,369
// 1@glast,44,371,0	warp2	#glast_event_warp_5	10,10,1@glast,105,369
// 1@glast,54,362,0	warp2	#glast_event_warp_6	10,10,1@glast,105,369
// 1@glast,44,358,0	warp2	#glast_event_warp_7	10,10,1@glast,105,369

// To stairs final room
1@glast,199,237,0	script	#glast_move_03	WARPNPC,2,2,{
	end;
OnTouch:
	if (getcharid(0) == getpartyleader(getcharid(1),2))
		warpparty 'map_glast$,197,263, getcharid(1), 'map_glast$,1,1;
	end;
}

// To final room
1@glast,199,294,0	script	#glast_move_03a	WARPNPC,3,3,{
	end;
OnTouch:
	if (getcharid(0) == getpartyleader(getcharid(1),2))
		warpparty 'map_glast$,188,334, getcharid(1), 'map_glast$,1,1;
	end;
}

// Exit final room
//1@glast,189,331,0	warp2	#glast_event_warp_11	10,10,1@glast,197,221
//1@glast,206,337,0	warp2	#glast_event_warp_12	10,10,1@glast,197,221
//1@glast,205,330,0	warp2	#glast_event_warp_13	10,10,1@glast,197,221
//1@glast,193,337,0	warp2	#glast_event_warp_14	10,10,1@glast,197,221
//1@glast,210,331,0	warp2	#glast_event_warp_15	10,10,1@glast,197,221
//1@glast,194,330,0	warp2	#glast_event_warp_16	10,10,1@glast,197,221

// Back to entrance
1@glast,351,269,0	script	#glast_move_04	WARPNPC,3,3,{
	end;
OnTouch:
	if (getcharid(0) == getpartyleader(getcharid(1),2)) {
		donpcevent instance_npcname("#sarah_wrath") + "::OnStop";
		warpparty 'map_glast$,349,282, getcharid(1), 'map_glast$,1,1;
	}
	end;
}

// Exit
1@glast,376,303,0	warp2	#glast_move_05	2,2,dali02,91,140

// Fenrir bottom
1@glast,216,48,0	script	#glast_event_5	HIDDEN_WARP_NPC,6,6,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_5");
	mes "";
	cutin "fenrir_a.bmp",2;
	npctalk "Фенрир: Ты не покинул"+(Sex?"":"а")+" Гластхейм?", 'fenrir_2$;
	sleep2 2000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Я в курсе, что здесь опасно, но мне стало любопытно, и я не смог"+(Sex?"":"ла")+" уйти...";
	sleep2 2000;
	npctalk "Фенрир: Хм. Приключенцы...", 'fenrir_2$;
	sleep2 2000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Не беспокойся! Мне не так-то просто навредить!";
	sleep2 2000;
	npctalk "Фенрир: Да?.. Как ты думаешь, не сможешь ли ты тогда мне помочь?", 'fenrir_2$;
	sleep2 2000;
	npctalk "Фенрир: То, что я ищу, где-то в Гластхейме!", 'fenrir_2$;
	viewpoint 1,47,270,1,0xFF0000;
	sleep2 2000;
	npctalk "Фенрир: Но за ним скоро придут и остальные!", 'fenrir_2$;
	sleep2 2000;
	npctalk "Фенрир: Это срочно. У нас есть не больше пяти минут!", 'fenrir_2$;
	sleep2 2000;
	npctalk "Фенрир: Я пойду вперёд и подожду тебя. Решишь присоединиться -- хорошо, нет -- пойду в одиночку.", 'fenrir_2$;
	sleep2 3000;
	cutin "",255;
	disablenpc 'fenrir_2$;
	sleep2 1000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Хм... Что же делать... Вообще-то у меня задание -- принести осколков профессору Бернхардту...";
	sleep2 2000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Стоит ли идти помогать этой сущности... или искать осколки..?";
	sleep2 2000;
	donpcevent instance_npcname("#fenrir_left_final_2") + "::OnStart";// timer (5 mins)
	for ( .@i = 1; .@i < 7; .@i++ )
		enablenpc instance_npcname("Древнейший гигант#glast_" + .@i);
	enablenpc 'fenrir_3$;
	enablenpc instance_npcname("#glast_event_7");
	disablenpc instance_npcname("#glast_move_01");	// officially player can be stucked in entrance
	end;
}

1@glast,216,52,6	script	Фенрир#glast_02	4_F_FENRIR,{ end; }

// Fenrir left side, entrance
1@glast,47,270,0	script	#glast_event_7	HIDDEN_WARP_NPC,5,5,{
	end;
OnTouch:
	if (getcharid(0) != getpartyleader(getcharid(1),2))
		npctalk "Фенрир: Пусть лидер твоего отряда подойдёт и поможет мне!", 'fenrir_3$;
	else {
		mes "";
		disablenpc instance_npcname("#glast_event_7");
		npctalk "Фенрир: А вот и ты! Наконец-то!", 'fenrir_3$;
		sleep2 2000;
		npctalk "Фенрир: Времени нет! Нужно идти на поиски!", 'fenrir_3$;
		sleep2 2000;
		if ('skip_left_part == 0) {// 5 mins have passed?
			donpcevent instance_npcname("#fenrir_left_final_2") + "::OnStop";
			disablenpc 'fenrir_3$;
			enablenpc 'fenrir_4$;
			enablenpc instance_npcname("#glast_event_9");
			warpparty 'map_glast$,41,348, getcharid(1), 'map_glast$,1,1;
		}
	}
	end;
}

1@glast,47,270,4	duplicate(#effect_glast_event01_1)	Фенрир#glast_03	4_F_FENRIR

// Fenrir left side, inside
1@glast,44,357,0	script	#glast_event_9	HIDDEN_WARP_NPC,3,3,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_9");
	mes "";
	cutin "fenrir_a.bmp",2;
	npctalk "Фенрир: Меч Бальдра, Ветер-Хранитель... Даже спустя тысячу лет...", 'fenrir_4$;
	sleep2 3000;
	npctalk "Фенрир: Я чувствую присутствие отродий зла... Как-будто их направляет чья-то воля.", 'fenrir_4$;
	sleep2 3000;
	npctalk "Фенрир: Кто-то решил составить мне компанию?", 'fenrir_4$;
	sleep2 3000;
	npctalk "Фенрир: Ничего страшного... Теперь осталось только взять Ветер-Хранитель и узнать, где Бальдр...", 'fenrir_4$;
	sleep2 3000;
	enablenpc 'sarah_10$;
	enablenpc instance_npcname("Гигант#semi1");
	enablenpc instance_npcname("Гигант#semi2");
	sleep2 1000;
	cutin "sarah_hero3.bmp",0;
	npctalk "Сара Ирен: Ха-ха. Вот оно что. Как я и ожидала.", 'sarah_10$;
	sleep2 3000;
	npctalk "Сара Ирен: Так дело было в мече?", 'sarah_10$;
	sleep2 3000;
	npctalk "Сара Ирен: Значит, так ломаются тысячелетние печати, Фенрир, Хрёдвитнир?", 'sarah_10$;
	sleep2 3500;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Ушам своим не верю. Фенрир, всё-таки тот самый!";
	npctalk "Фенрир: Ушам своим не верю... Валькирия! Игры кончились.", 'fenrir_4$;
	cutin "fenrir_b.bmp",2;
	sleep2 5000;
	npctalk "Сара Ирен: Хоть и запоздало, но приветствую. Моё имя Сара Ирен, Валькирия из Дюжины Вальгаллы.", 'sarah_10$;
	cutin "sarah_hero3.bmp",0;
	sleep2 3000;
	npctalk "Сара Ирен: А так же эмиссар Фрейи, исполняющий её волю...", 'sarah_10$;
	npctalk "Фенрир: Два Гиганта! Это будет нелёгкий бой. Помоги мне с ними!", 'fenrir_4$;
	cutin "fenrir_b.bmp",2;
	sleep2 3000;
	npctalk "Сара Ирен: Вперёд! Гиганты! Мои верные чудовища!", 'sarah_10$;
	npctalk "Фенрир: Сара спрячется и будет и дальше призывать чудовищ! Разберись с Гигантами, а я возьму на себя остальное!", 'fenrir_4$;
	cutin "fenrir_b.bmp",255;
	sleep2 2000;
	disablenpc 'sarah_10$;
	disablenpc instance_npcname("Гигант#semi1");
	disablenpc instance_npcname("Гигант#semi2");
	enablenpc instance_npcname("#fenrir_left_final_1");
	monster 'map_glast$,49,363, "Гигант#semi1", 3191,1, instance_npcname("#fenrir_left_final_1") + "::OnMobDead";// MM_M_GIGAN1
	monster 'map_glast$,41,363, "Гигант#semi2", 3192,1, instance_npcname("#fenrir_left_final_1") + "::OnMobDead";// MM_M_GIGAN2
	donpcevent instance_npcname("#glast_event_9") + "::OnEvent";
	end;
OnEvent:
	sleep 15000;
	'timer_left_side = 0;
	donpcevent instance_npcname("#glast_event_9") + "::OnStart";
	end;

OnStart:
	initnpctimer;
	npctalk "Фенрир: В небе живущие токи! Явите же свою мощь!", 'fenrir_4$;
	callsub S_Spawn,1,3198;// MM_M_GALION

	progressbar_npc "000000",5, 'fenrir_4$;	// note: display effect after dead of Gigantes
	npctalk "Фенрир: Молния!!!", 'fenrir_4$;
	for ( .@i = 1; .@i < 9; .@i++ )
		specialeffect EF_LIGHTBOLT, AREA, instance_npcname("#effect_glast_event02_" + .@i);
	end;
OnTimer6000:
	killmonster 'map_glast$, instance_npcname("#glast_event_9") + "::OnMobDead";
	end;
OnTimer15000:
	npctalk "Фенрир: Вселенной пылающий зев поглотит следы обречённых! Огонь преисподней пожрёт! ", 'fenrir_4$;
	callsub S_Spawn,2,3198;// MM_M_GALION
	progressbar_npc "000000",5, 'fenrir_4$;
	npctalk "Фенрир: Метеоритный дождь!!!", 'fenrir_4$;
	for ( .@i = 1; .@i < 9; .@i++ )
		specialeffect EF_METEORSTORM, AREA, instance_npcname("#effect_glast_event02_" + .@i);
	end;
OnTimer21000:
	killmonster 'map_glast$, instance_npcname("#glast_event_9") + "::OnMobDead";
	end;
OnTimer30000:
	npctalk "Фенрир: В небе живущие токи! Явите же свою мощь! ", 'fenrir_4$;
	callsub S_Spawn,1,3199;// MM_M_MUTANT_DRAGON
	progressbar_npc "000000",5, 'fenrir_4$;
	npctalk "Фенрир: Молния!!!", 'fenrir_4$;
	for ( .@i = 1; .@i < 9; .@i++ )
		specialeffect EF_LIGHTBOLT, AREA, instance_npcname("#effect_glast_event02_" + .@i);
	end;
OnTimer36000:
	killmonster 'map_glast$, instance_npcname("#glast_event_9") + "::OnMobDead";
	end;
OnTimer45000:
	npctalk "Фенрир: Дыханье зимы остановит шаги обречённых! Морозная мгла до души доберётся! ", 'fenrir_4$;
	callsub S_Spawn,2,3199;// MM_M_MUTANT_DRAGON
	progressbar_npc "000000",5, 'fenrir_4$;
	npctalk "Фенрир: Буран!!!", 'fenrir_4$;
	for ( .@i = 1; .@i < 9; .@i++ )
		specialeffect EF_STORMGUST, AREA, instance_npcname("#effect_glast_event02_" + .@i);
	end;
OnTimer51000:
	killmonster 'map_glast$, instance_npcname("#glast_event_9") + "::OnMobDead";
	end;
OnTimer55000:
	'timer_left_side++;
	if ('timer_left_side == 5) {
		stopnpctimer;
		donpcevent instance_npcname("#fenrir_left_vermilion") + "::OnEvent";
	}
	end;
OnTimer60000:
	donpcevent instance_npcname("#glast_event_9") + "::OnStart";
	end;

OnStop:
	stopnpctimer;
	end;

OnMobDead:
	end;

S_Spawn:
	.@mob_id = getarg(1);
	.@label$ = instance_npcname("#glast_event_9") + "::OnMobDead";
	if (getarg(0) == 1) {
		monster 'map_glast$,43,355, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,39,361, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,48,361, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,43,363, "--ja--", .@mob_id,1, .@label$;
	}
	else {
		monster 'map_glast$,37,360, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,37,362, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,37,364, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,37,366, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,37,368, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,41,371, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,50,360, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,50,362, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,50,364, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,50,366, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,50,368, "--ja--", .@mob_id,1, .@label$;
		monster 'map_glast$,46,371, "--ja--", .@mob_id,1, .@label$;
	}
	return;
}

1@glast,1,1,0	script	#fenrir_left_vermilion	HIDDEN_WARP_NPC,{
	end;
OnEvent:
	enablenpc instance_npcname("#fenrir_left_vermilion");
	initnpctimer;
	npctalk "Фенрир: Конца им нет. Пора это прекратить.", 'fenrir_4$;
	progressbar_npc "000000",10, 'fenrir_4$;
	end;
OnTimer2000:
	npctalk "Фенрир: Властитель безмерно далёкий, дыханье твоё закатно!", 'fenrir_4$;
	end;
OnTimer4000:
	npctalk "Фенрир: Там, где ступаешь ты, лишь пустота остаётся.", 'fenrir_4$;
	end;
OnTimer7000:
	npctalk "Фенрир: Пусть вздрогнут основы земные!", 'fenrir_4$;
	end;
OnTimer10000:
	stopnpctimer;
	npctalk "Фенрир: Владыка Вермилиона!!!", 'fenrir_4$;
	for ( .@i = 1; .@i < 9; .@i++ )
		specialeffect EF_LORD, AREA, instance_npcname("#effect_glast_event02_" + .@i);
	killmonster 'map_glast$, instance_npcname("#fenrir_left_final_1") + "::OnMobDead";
	donpcevent instance_npcname("#fenrir_left_final_1") + "::OnStart";
	disablenpc instance_npcname("#fenrir_left_vermilion");
	end;
OnStop:
	stopnpctimer;
	disablenpc instance_npcname("#fenrir_left_vermilion");
	end;
}

1@glast,1,1,0	script	#fenrir_left_final_1	HIDDEN_WARP_NPC,{
	end;
OnStart:
	initnpctimer;
	end;
OnTimer2000:
	npctalk "Фенрир: Отлично! Гиганты побеждены!", 'fenrir_4$;
	enablenpc 'sarah_10$;
	end;
OnTimer4000:
	npctalk "Сара Ирен: Как я и предполагала, Фенрир, ты не сдаёшься легко!", 'sarah_10$;
	end;
OnTimer7000:
	npctalk "Фенрир: Сейчас же отойди от Ветра-Хранителя!", 'fenrir_4$;
	end;
OnTimer9000:
	npctalk "Сара Ирен: Ха-ха... Не могу!", 'sarah_10$;
	specialeffect EF_WL_TELEKINESIS_INTENSE, AREA, instance_npcname("#effect_glast_event02_bis");
	end;
OnTimer11000:
	npctalk "Сара Ирен: Если хочешь вернуть его, приходи к замку! Я буду ждать!", 'sarah_10$;
	end;
OnTimer13000:
	specialeffect EF_FIREPILLARON2, AREA, 'sarah_10$;
	end;
OnTimer14000:
	disablenpc 'sarah_10$;
	end;
OnTimer16000:
	npctalk "Фенрир: Быстрее, догоним её! Я открою нам пространство для прыжка!", 'fenrir_4$;
	end;
OnTimer19000:
	npctalk "Фенрир: Расширенное искривление пространства!", 'fenrir_4$;
	end;
OnTimer20000:
	stopnpctimer;
	//for ( .@i = 1; .@i < 8; .@i++ )
	//	enablenpc instance_npcname("#glast_event_warp_" + .@i);	// warp to 105,369
	areawarp 'map_glast$,26,338,59,375, 'map_glast$,105,369;
	for ( .@i = 1; .@i < 9; .@i++ )
		disablenpc instance_npcname("#effect_glast_event02_" + .@i);
	disablenpc instance_npcname("#effect_glast_event02_bis");
	disablenpc instance_npcname("#fenrir_left_final_1");
	disablenpc 'fenrir_4$;
	enablenpc instance_npcname("#glast_event_13");
	enablenpc 'fenrir_5$;
	end;

OnMobDead:
	if (mobcount( 'map_glast$, instance_npcname("#fenrir_left_final_1") + "::OnMobDead" ) < 1) {
		donpcevent instance_npcname("#glast_event_9") + "::OnStop";
		donpcevent instance_npcname("#fenrir_left_vermilion") + "::OnStop";
		donpcevent instance_npcname("#fenrir_left_final_1") + "::OnStart";
	}
	end;
}

1@glast,44,357,8	duplicate(#effect_glast_event01_1)	Фенрир#glast_04	4_F_FENRIR
1@glast,49,363,4	duplicate(#effect_glast_event01_1)	Гигант#semi1	4_GIGANTES_SMALL
1@glast,41,363,4	duplicate(#effect_glast_event01_1)	Гигант#semi2	4_GIGANTES_SMALL
1@glast,46,364,4	duplicate(#effect_glast_event01_1)	Сара Ирен#glast_10	4_F_SARAH

1@glast,52,345,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_1	CLEAR_NPC
1@glast,44,350,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_2	CLEAR_NPC
1@glast,35,360,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_3	CLEAR_NPC
1@glast,44,360,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_4	CLEAR_NPC
1@glast,52,360,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_5	CLEAR_NPC
1@glast,35,368,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_6	CLEAR_NPC
1@glast,53,368,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_7	CLEAR_NPC
1@glast,44,371,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_8	CLEAR_NPC
1@glast,44,366,4	duplicate(#effect_glast_event01_1)	#effect_glast_event02_bis	CLEAR_NPC

// Event top side
1@glast,133,365,0	script	#glast_event_13	HIDDEN_WARP_NPC,8,8,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_13");
	//for ( .@i = 1; .@i < 8; .@i++ )
	//	disablenpc instance_npcname("#glast_event_warp_" + .@i);
	mes "";
	cutin "fenrir_a.bmp",2;
	sleep2 1000;
	npctalk "Фенрир: Мне нужен меч Бальдра, поэтому я направляюсь в замок.", 'fenrir_5$;
	sleep2 3000;
	npctalk "Фенрир: Но в одиночку это может оказаться... трудновато, и я с благодарностью приму твою помощь.", 'fenrir_5$;
	sleep2 3000;
	npctalk "Фенрир: Времени у нас в обрез.", 'fenrir_5$;
	sleep2 3000;
	npctalk "Фенрир: Я буду ждать тебя у замка 5 минут.", 'fenrir_5$;
	sleep2 3000;
	npctalk "Фенрир: Так как затея небезопасна, не считай, что ты мне что-то долж"+(Sex?"ен":"на")+". Не придешь так не придешь.", 'fenrir_5$;
	viewpoint 1,199,237,1,0xFF0000;
	sleep2 3000;
	npctalk "Фенрир: Ну, мне пора. Телепорт!", 'fenrir_5$;
	cutin "",255;
	donpcevent instance_npcname("#glast_event_13") + "::OnBar";
	end;
OnBar:
	progressbar_npc "000000",3, 'fenrir_5$;
	disablenpc 'fenrir_5$;
	donpcevent instance_npcname("#fenrir_boss_final_2") + "::OnStart";// timer (5 mins)
	enablenpc instance_npcname("#glast_move_03");
	enablenpc instance_npcname("#glast_event_15");
	enablenpc 'fenrir_6$;
	end;
}

1@glast,133,365,4	duplicate(#effect_glast_event01_1)	Фенрир#glast_05	4_F_FENRIR

// Skipped left side
1@glast,1,1,0	script	#fenrir_left_final_2	HIDDEN_WARP_NPC,{
	end;
OnStart:
	enablenpc instance_npcname("#fenrir_left_final_2");
	initnpctimer;
	end;
OnTimer300000:
	'skip_left_part = 1;
	disablenpc instance_npcname("#glast_event_7");
	disablenpc 'fenrir_3$;
	mapannounce 'map_glast$, "Фенрир: Отлично! Гиганты побеждены!", bc_map,0xEBFF;
	end;
OnTimer302000:
	mapannounce 'map_glast$, "Сара Ирен: Как я и ожидала, Фенрир, легко тебя не взять!", bc_map,0xEBFF;
	end;
OnTimer305000:
	mapannounce 'map_glast$, "Фенрир: Отойди от Ветра-Хранителя!", bc_map,0xEBFF;
	end;
OnTimer307000:
	mapannounce 'map_glast$, "Сара Ирен: Ха-ха... Не могу!", bc_map,0xEBFF;
	end;
OnTimer309000:
	mapannounce 'map_glast$, "Сара Ирен: Хочешь его? Приходи к донжону, я буду ждать!", bc_map,0xEBFF;
	end;
OnTimer311000:
	mapannounce 'map_glast$, "Фенрир: Мне нужен меч Бальдра, я пойду за ним в замок Гластхейма.", bc_map,0xEBFF;
	end;
OnTimer313000:
	mapannounce 'map_glast$, "Фенрир: Но в одиночку может оказаться трудно. Если ты меня слышишь, я с благодарностью приму твою помощь.", bc_map,0xEBFF;
	end;
OnTimer315000:
	mapannounce 'map_glast$, "Фенрир: Однако у нас не так много времени.", bc_map,0xEBFF;
	end;
OnTimer317000:
	mapannounce 'map_glast$, "Фенрир: Я буду ждать около центрального замка Гластхейма в течение 5 минут.", bc_map,0xEBFF;
	end;
OnTimer319000:
	stopnpctimer;
	mapannounce 'map_glast$, "Фенрир: Так как это опасно, об обязательствах речи нет. Придешь так придешь, нет так нет.", bc_map,0xEBFF;
	enablenpc instance_npcname("#glast_move_03");
	enablenpc 'fenrir_6$;
	enablenpc instance_npcname("#glast_event_15");
	disablenpc instance_npcname("#fenrir_left_final_2");
	donpcevent instance_npcname("#fenrir_boss_final_2") + "::OnStart";// timer (5 mins)
	end;
OnStop:
	stopnpctimer;
	disablenpc instance_npcname("#fenrir_left_final_2");
	end;
}

// Stairs final room
1@glast,200,268,0	script	#glast_event_15	HIDDEN_WARP_NPC,7,7,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_move_03");
	disablenpc instance_npcname("#glast_event_15");
	donpcevent instance_npcname("#fenrir_boss_final_2") + "::OnStop";
	mes "";
	sleep2 1000;
	npctalk "Фенрир: А вот и ты. Спасибо, что не опоздал"+(Sex?"":"а")+".", 'fenrir_6$;
	sleep2 3000;
	npctalk "Фенрир: Остался последний шаг! Сара ждёт!", 'fenrir_6$;
	sleep2 3000;
	disablenpc 'fenrir_6$;
	enablenpc instance_npcname("#glast_move_03a");
	enablenpc instance_npcname("#glast_event_18");
	enablenpc instance_npcname("Сара Ирен#glast_17");
	enablenpc 'fenrir_7$;
	end;
}

1@glast,200,268,4	duplicate(#effect_glast_event01_1)	Фенрир#glast_06	4_F_FENRIR

// Final room
1@glast,199,336,0	script	#glast_event_18	HIDDEN_WARP_NPC,10,10,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_18");
	mes "";
	cutin "sarah_hero3.bmp",0;
	sleep2 1000;
	npctalk "Сара Ирен: Думала, что не дождусь тебя, Фенрир.", 'sarah_17$;
	sleep2 3000;
	cutin "fenrir_b.bmp",2;
	npctalk "Фенрир: Хватит болтовни, верни меч!", 'fenrir_7$;
	sleep2 3000;
	cutin "sarah_hero3.bmp",0;
	npctalk "Сара Ирен: Возьми, если сможешь.", 'sarah_17$;
	sleep2 3000;
	cutin "fenrir_b.bmp",2;
	npctalk "Фенрир: Сара может оказаться для тебя непосильным противником. С ней сражусь я!", 'fenrir_7$;
	sleep2 3000;
	npctalk "Фенрир: Оковы чистой белизны, извечная тюрьма! Союз исполнить наш пришла пора!", 'fenrir_7$;
	donpcevent instance_npcname("#glast_event_18") + "::OnBar";
	sleep2 3000;
	npctalk "Фенрир: Обьятья Хель!!!", 'fenrir_7$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	sleep2 3000;
	npctalk "Сара Ирен: Кх... Ха...", 'sarah_17$;
	npctalk "Фенрир: Я ослаблю Сару оковами и сражусь с ней.", 'fenrir_7$;
	sleep2 3000;
	npctalk "Фенрир: А ты позаботься о её слугах. Я рассчитываю на тебя.", 'fenrir_7$;
	sleep2 3000;
	unittalk getcharid(3), "" + strcharinfo(0) + " : Можешь на меня положиться. Сильные враги меня воодушевляют.";
	sleep2 6000;
	npctalk "Фенрир: Вот наша тактика: атакуем вместе и прикончим её, пока у нас есть серьезное преимущество. Помни, наш враг силён.", 'fenrir_7$;
	sleep2 3000;
	cutin "sarah_hero3_2.bmp",0;
	npctalk "Сара Ирен: Так это и был твой план, связать мне руки своими уловками?", 'sarah_17$;
	sleep2 3000;
	npctalk "Сара Ирен: Мало того, ты ещё и наёмников привёл...", 'sarah_17$;
	sleep2 3000;
	npctalk "Сара Ирен: Нужно помочь тебе раствориться вместе с этим ржавым куском железа!", 'sarah_17$;
	sleep2 3000;
	cutin "",255;
	hideonnpc 'sarah_17$;
	donpcevent instance_npcname("#glast_event_19") + "::OnEvent";
	monster 'map_glast$,200,336, "Сара Ирен#1",3190,1, instance_npcname("#fenrir_boss_final_1") + "::OnBossDead";	// MM_SARAH
	'boss_id = $@mobid[0];
	end;
OnBar:
	progressbar_npc "000000",3, 'fenrir_7$;
	end;
}

1@glast,200,336,4	duplicate(#effect_glast_event01_1)	Сара Ирен#glast_17	4_F_SARAH

1@glast,197,330,8	script	Фенрир#glast_07	4_F_FENRIR,{
	end;
OnStart:
	initnpctimer;
	end;
OnTimer1000:
	specialeffect EF_TETRACASTING;
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
}

1@glast,212,350,0	script	#glast_event_19	HIDDEN_WARP_NPC,{
	end;
OnEvent:
	enablenpc instance_npcname("#glast_event_19");
	enablenpc instance_npcname("#fenrir_boss_final_1");
	initnpctimer;
	specialeffect EF_PRIMECHARGE4, AREA, 'fenrir_7$;
	npctalk "Фенрир: Облако мрака, гибельный яд! Смерти посланник, мученья без меры!", 'fenrir_7$;
	monster 'map_glast$,190,341, "Гигант#a1", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,214,331, "Гигант#b2", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer1000:
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer10000:
	callsub S_Hit,1;
	npctalk "Фенрир: Гибельное облако!!!", 'fenrir_7$;
	specialeffect EF_POISONSMOKE, AREA, 'sarah_17$;
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_POISONSMOKE, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer10500:
	unittalk 'boss_id, "Сара Ирен: Надо же, Фенрир. И что, это всё?";
	end;
OnTimer11000:
	specialeffect EF_POISONSMOKE2, AREA, 'sarah_17$;
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_1");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_2");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_3");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_4");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_5");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_6");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_7");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_8");
	end;
OnTimer13000:
	npctalk "Фенрир: Облако мрака, гибельный яд! Смерти посланник, мученья без меры!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE4, AREA, 'fenrir_7$;
	specialeffect EF_POISONSMOKE2, AREA, 'sarah_17$;
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_1");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_2");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_3");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_4");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_5");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_6");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_7");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_8");
	end;
OnTimer20000:
	callsub S_Hit,2;
	npctalk "Фенрир: Смертельное облако!!!", 'fenrir_7$;
	specialeffect EF_POISONSMOKE, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_POISONSMOKE, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	progressbar_npc "000000",30, 'fenrir_7$;
	end;
OnTimer20500:
	unittalk 'boss_id, "Сара Ирен: Придумай что-нибудь повеселее!";
	end;
OnTimer21000:
	specialeffect EF_POISONSMOKE2, AREA, 'sarah_17$;
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_1");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_2");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_3");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_4");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_5");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_6");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_7");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_8");
	end;
OnTimer23000:
	npctalk "Фенрир: Пламени песня, тебя призываю! Неугасимый спутник заката...", 'fenrir_7$;
	specialeffect EF_BEGINSPELL_YB, AREA, 'fenrir_7$;
	specialeffect EF_POISONSMOKE2, AREA, 'sarah_17$;
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_1");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_2");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_3");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_4");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_5");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_6");
	specialeffect EF_POISONSMOKE2, AREA, instance_npcname("#effect_glast_event03_7");
	specialeffect EF_ENCHANTPOISON, AREA, instance_npcname("#effect_glast_event03_8");
	end;
OnTimer36000:
	npctalk "Фенрир: Имя моё -- властное слово: Фенрир, Хрёдвитнир.", 'fenrir_7$;
	specialeffect EF_BEGINSPELL_YB, AREA, 'fenrir_7$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer50000:
	callsub S_Hit,3;
	npctalk "Фенрир: Огненный символ!", 'fenrir_7$;
	specialeffect EF_DEMONICFIRE, AREA, 'sarah_17$;
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer50500:
	unittalk 'boss_id, "Сара Ирен: Ох... Неплохо? Но недостаточно!";
	end;
OnTimer51000:
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer53000:
	npctalk "Фенрир: Корень земли! Твоя мощь потрясает сердца врагов!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE4, AREA, 'fenrir_7$;
	end;
OnTimer60000:
	callsub S_Hit,4;
	npctalk "Фенрир: Землетрясение!", 'fenrir_7$;
	specialeffect EF_HEAVENSDRIVE, AREA, 'sarah_17$;
	monster 'map_glast$,190,341, "Гигант#a1", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,214,331, "Гигант#b2", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer60500:
	unittalk 'boss_id, "Сара Ирен: Брось уже свои детские выходки, Фенрир.";
	end;
OnTimer63000:
	specialeffect EF_PRIMECHARGE4, AREA, 'fenrir_7$;
	npctalk "Фенрир: Основы земные пусть пошатнутся грозною силой!", 'fenrir_7$;
	end;
OnTimer70000:
	callsub S_Hit,5;
	npctalk "Фенрир: Землетрясение!", 'fenrir_7$;
	specialeffect EF_HEAVENSDRIVE, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	progressbar_npc "000000",30, 'fenrir_7$;
	end;
OnTimer70500:
	unittalk 'boss_id, "Сара Ирен: Думаешь победить меня этим?";
	end;
OnTimer73000:
	npctalk "Фенрир: Северных ветров немилых сурово дыханье...", 'fenrir_7$;//Северных ветров сурово дыханье, всё затумань! Морозная дымка!
	specialeffect EF_PRIMECHARGE2, AREA, 'fenrir_7$;
	end;
OnTimer85000:
	npctalk "Фенрир: Инеем всё затяни!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE2, AREA, 'fenrir_7$;
	end;
OnTimer100000:
	callsub S_Hit,6;
	npctalk "Фенрир: Морозная дымка!!!", 'fenrir_7$;
	specialeffect EF_FROSTMYSTY, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	specialeffect EF_FROSTMYSTY, AREA, 'sarah_17$;
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer100500:
	unittalk 'boss_id, "Сара Ирен: Не самая плохая попытка!";
	end;
OnTimer103000:
	npctalk "Фенрир: Разума хитрого скрытые силы являя, меч пробуди!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE, AREA, 'fenrir_7$;
	end;
OnTimer110000:
	callsub S_Hit,7;
	npctalk "Фенрир: Силовая волна!!!", 'fenrir_7$;
	specialeffect EF_SPR_PLANT10, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer110500:
	unittalk 'boss_id, "Сара Ирен: Кх... Не получится, Фенрир!";
	end;
OnTimer113000:
	npctalk "Фенрир: Тайные бездны ума раскрывая, воздух сомни!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE, AREA, 'fenrir_7$;
	end;
OnTimer120000:
	callsub S_Hit,8;
	npctalk "Фенрир: Силовая волна!!!", 'fenrir_7$;
	specialeffect EF_SPR_PLANT10, AREA, 'sarah_17$;
	monster 'map_glast$,190,341, "Гигант#a1", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,214,331, "Гигант#b2", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	progressbar_npc "000000",30, 'fenrir_7$;
	end;
OnTimer120500:
	unittalk 'boss_id, "Сара Ирен: Кхрх... Твои потуги уже становятся однообразными!";
	end;
OnTimer123000:
	npctalk "Фенрир: Пламени песня, тебя призываю! Неугасимый спутник заката...", 'fenrir_7$;
	specialeffect EF_BEGINSPELL_YB, AREA, 'fenrir_7$;
	end;
OnTimer135000:
	npctalk "Фенрир: Имя моё -- властное слово: Фенрир, Хрёдвитнир.", 'fenrir_7$;
	specialeffect EF_BEGINSPELL_YB, AREA, 'fenrir_7$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer150000:
	callsub S_Hit,9;
	npctalk "Фенрир: Огненный символ!!!", 'fenrir_7$;
	specialeffect EF_DEMONICFIRE, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer150500:
	unittalk 'boss_id, "Сара Ирен: Я -- Сара Ирен! Я не сдамся так просто!!!";
	end;
OnTimer153000:
	npctalk "Фенрир: Неба праведный гнев! Гром, что землю расколет! Предо мною пади...", 'fenrir_7$;
	specialeffect EF_DQ9_CHARGE3, AREA, 'fenrir_7$;
	end;
OnTimer160000:
	callsub S_Hit,10;
	npctalk "Фенрир: Гр-ром и молния!!!", 'fenrir_7$;
	specialeffect EF_THUNDERSTORM2, AREA, 'sarah_17$;
	unittalk 'boss_id, "Сара Ирен: Кххх... Ты... сильнее, чем я думала, Фенрир...";
	progressbar_npc "000000",10, 'fenrir_7$;
	end;
OnTimer160500:
	unittalk 'boss_id, "Сара Ирен: Мкх... Ты... сильнее, чем я думала, Фенрир...";
	end;
OnTimer163000:
	npctalk "Фенрир: Неба гневный оглас, праведной вспышки миг! Предо мною пади!", 'fenrir_7$;
	specialeffect EF_DQ9_CHARGE3, AREA, 'fenrir_7$;
	end;
OnTimer170000:
	callsub S_Hit,11;
	npctalk "Фенрир: Гром и молния!!!", 'fenrir_7$;
	specialeffect EF_THUNDERSTORM2, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	progressbar_npc "000000",30, 'fenrir_7$;
	end;
OnTimer170500:
	unittalk 'boss_id, "Сара Ирен: Аакхх!!! Аааахх!!!";
	end;
OnTimer173000:
	npctalk "Фенрир: Северных ветров вой!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE2, AREA, 'fenrir_7$;
	end;
OnTimer180000:
	monster 'map_glast$,190,341, "Гигант#a1", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,185,331, "Гигант#a2", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,209,341, "Гигант#b1", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	monster 'map_glast$,214,331, "Гигант#b2", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	end;
OnTimer185000:
	npctalk "Фенрир: Дыхание злой зимы!", 'fenrir_7$;
	specialeffect EF_PRIMECHARGE2, AREA, 'fenrir_7$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer200000:
	callsub S_Hit,12;
	npctalk "Фенрир: Изморозью придёт твой ледяной туман!!!", 'fenrir_7$;
	specialeffect EF_FROSTMYSTY, AREA, 'sarah_17$;
	donpcevent 'fenrir_7$ + "::OnStart";
	progressbar_npc "000000",50, 'fenrir_7$;
	end;
OnTimer200500:
	unittalk 'boss_id, "Сара Ирен: Ааах!!! Вам всем конец!!!";
	specialeffect EF_FROSTMYSTY, AREA, 'sarah_17$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer203000:
	npctalk "Фенрир: Неба разящий клинок!", 'fenrir_7$;
	specialeffect EF_BLACKBODY, AREA, 'fenrir_7$;
	specialeffect EF_RECOGNIZED, AREA, 'fenrir_7$;
	end;
OnTimer216000:
	npctalk "Фенрир: Сила, что бездну расколет!", 'fenrir_7$;
	end;
OnTimer230000:
	npctalk "Фенрир: Предо мною пади!", 'fenrir_7$;
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer239000:
	monster 'map_glast$,190,341, "Гигант#a1", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,185,331, "Гигант#a2", 3194,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN1
	monster 'map_glast$,209,341, "Гигант#b1", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	monster 'map_glast$,214,331, "Гигант#b2", 3195,1, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";// MM_L_GIGAN2
	end;
OnTimer240000:
	npctalk "Фенрир: Лезвие жизни и смерти, клинок мирозданья! Вспышка, что небо пронзает...", 'fenrir_7$;
	end;
OnTimer250000:
	npctalk "Фенрир: Копьё Вератюра!!!", 'fenrir_7$;
	specialeffect EF_PRESSURE3, AREA, 'sarah_17$;
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_PRESSURE3, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	end;
OnTimer253000:
	setunitdata 'boss_id, UMOB_HP, 100;
	specialeffect EF_PRESSURE3, AREA, 'sarah_17$;
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_PRESSURE3, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	npctalk "Фенрир: Сейчас! Сара критически ослаблена! Прикончи её, атакуй быстрее! Она очень сильна!", 'fenrir_7$;
	mapannounce 'map_glast$, "Фенрир: Сейчас! Сара критически ослаблена! Прикончи её, атакуй быстрее! Она очень сильна!", bc_map,0xEBFF;
	npctalk "Сара Ирен: Хркх... не... не может быть!!! Я не могу проиграть!!!", 'sarah_17$;
	end;
OnTimer263000:
	npctalk "Фенрир: Может, тебе не удастся сам"+(Sex?"ому":"ой")+" нанести последний удар, тогда я подготовлю последнее заклинание!", 'fenrir_7$;
	progressbar_npc "000000",50, 'fenrir_7$;
	end;
OnTimer273000:
	specialeffect EF_BOTTOM_BASILICA2, AREA, 'sarah_17$;
	npctalk "Фенрир: Неба карающий меч! Горький вопль обречённых!", 'fenrir_7$;
	specialeffect EF_RECOGNIZED, AREA, 'fenrir_7$;
	specialeffect EF_BLACKBODY, AREA, 'fenrir_7$;
	end;
OnTimer283000:
	npctalk "Фенрир: Силой своей переполни свидетеля слово!", 'fenrir_7$;
	end;
OnTimer293000:
	npctalk "Фенрир: Лезвие жизни и смерти, клинок мирозданья!";
	end;
OnTimer303000:
	npctalk "Фенрир: Вспышка, что небо пронзает... ";
	end;
OnTimer313000:
	npctalk "Фенрир: Копьё Вератюра!!!";
	specialeffect EF_PRESSURE3, AREA, 'sarah_17$;
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_PRESSURE3, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	donpcevent 'fenrir_7$ + "::OnStop";
	end;
OnTimer316000:
	specialeffect EF_PRESSURE3, AREA, 'sarah_17$;
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_PRESSURE3, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	killmonster 'map_glast$, instance_npcname("#fenrir_boss_final_1") + "::OnBossDead";
	donpcevent instance_npcname("#fenrir_boss_final_1") + "::OnBossDead";
	end;

OnStop:
	stopnpctimer;
	disablenpc instance_npcname("#glast_event_19");
	end;

S_Hit:
	getunitdata 'boss_id, .@data;
	.@hp = .@data[UMOB_MAXHP] - ((.@data[UMOB_MAXHP] * getarg(0)) / 13);
	setunitdata 'boss_id, UMOB_HP, .@hp;
	return;
}

1@glast,1,1,0	script	#fenrir_boss_final_1	HIDDEN_WARP_NPC,{
	end;
OnBossDead:
	donpcevent instance_npcname("#glast_event_19") + "::OnStop";
	initnpctimer;
	end;
OnTimer1000:
	killmonster 'map_glast$, instance_npcname("#fenrir_boss_final_1") + "::OnMobDead";
	end;
OnTimer6000:
	disablenpc 'sarah_17$;
	disablenpc 'fenrir_7$;
	enablenpc 'fenrir_8$;
	enablenpc 'sarah_20$;
	end;
OnTimer9000:
	npctalk "Фенрир: Ветер-Хранитель! Наконец-то он в моих руках!", 'fenrir_8$;
	end;
OnTimer12000:
	npctalk "Сара Ирен: Хркх....", 'sarah_20$;
	end;
OnTimer15000:
	npctalk "Фенрир: С ним я найду Бальдра!", 'fenrir_8$;
	end;
OnTimer18000:
	npctalk "Сара Ирен: Рано радуешься!", 'sarah_20$;
	progressbar_npc "000000",2, 'sarah_20$;
	end;
OnTimer21000:
	specialeffect EF_FIREPILLARON, AREA, 'fenrir_8$;
	disablenpc 'fenrir_8$;
	enablenpc 'fenrir_9$;
	end;
OnTimer24000:
	npctalk "Сара Ирен: Ха-ха... Крыса вёрткая.", 'sarah_20$;
	end;
OnTimer27000:
	npctalk "Сара Ирен: Но я не могу позволить тебе уйти вот так.", 'sarah_20$;
	end;
OnTimer30000:
	npctalk "Сара Ирен: Я взорву вместе с тобой весь замок! Йаааа!!!", 'sarah_20$;
	progressbar_npc "000000",15, 'sarah_20$;
	end;
OnTimer33000:
	npctalk "Фенрир: Она собирается всё разрушить! Мне придётся совершить пространственный прыжок!", 'fenrir_9$;
	progressbar_npc "000000",6, 'fenrir_9$;
	end;
OnTimer36000:
	npctalk "Фенрир: Прощай, Валькирия! Я заберу Ветер-Хранитель. Счастливо оставаться!", 'fenrir_9$;
	end;
OnTimer39000:
	for ( .@i = 1; .@i <= 8; .@i++ )
		specialeffect EF_LORD, AREA, instance_npcname("#effect_glast_event03_" + .@i);
	disablenpc 'fenrir_9$;
	end;
OnTimer40000:
	stopnpctimer;
	enablenpc instance_npcname("#glast_event_24");
	enablenpc instance_npcname("Фенрир#glast_10");
	//for ( .@i = 11; .@i <= 16; .@i++ )
	//	enablenpc instance_npcname("#glast_event_warp_" + .@i);// warp to 197,221
	areawarp 'map_glast$,181,326,218,352, 'map_glast$,197,221;
	for ( .@i = 1; .@i <= 8; .@i++ )
		disablenpc instance_npcname("#effect_glast_event03_" + .@i);
	disablenpc 'sarah_20$;
	disablenpc instance_npcname("#fenrir_boss_final_1");
	end;

OnMobDead:
	end;
}

1@glast,199,348,8	duplicate(#effect_glast_event01_1)	Фенрир#glast_08	4_F_FENRIR
1@glast,201,346,4	duplicate(#effect_glast_event01_1)	Фенрир#glast_09	4_F_FENRIR
1@glast,197,339,8	duplicate(#effect_glast_event01_1)	Сара Ирен#glast_20	4_F_SARAH

1@glast,201,336,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_1	CLEAR_NPC
1@glast,201,337,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_2	CLEAR_NPC
1@glast,200,337,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_3	CLEAR_NPC
1@glast,199,337,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_4	CLEAR_NPC
1@glast,199,336,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_5	CLEAR_NPC
1@glast,199,335,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_6	CLEAR_NPC
1@glast,200,335,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_7	CLEAR_NPC
1@glast,201,335,4	duplicate(#effect_glast_event01_1)	#effect_glast_event03_8	CLEAR_NPC

// Outside final room
1@glast,200,224,0	script	#glast_event_24	HIDDEN_WARP_NPC,7,7,{
	end;
OnTouch:
	disablenpc instance_npcname("#glast_event_24");
	mes "";
	sleep2 1500;
	cutin "fenrir_b.bmp",2;
	npctalk "Фенрир: Хе-хе. Ты ведь умелая воительница, однако, мне кажется, ты недооцениваешь меня, Валькирия.", 'fenrir_10$;
	sleep2 3000;
	mapannounce 'map_glast$, "Сара Ирен: Так удиви же меня, Фенрир...", bc_map,0xEBFF;
	sleep2 3000;
	mapannounce 'map_glast$, "Сара Ирен: Неужели ты думаешь, что я дам тебе так просто сбежать?", bc_map,0xEBFF;
	sleep2 3000;
	mapannounce 'map_glast$, "Сара Ирен: Я превращу в ад весь Гластхейм!", bc_map,0xEBFF;
	sleep2 3000;
	npctalk "Фенрир: Если мы сейчас же не уберемся, нас ждёт незавидная судьба от её чудовищ и магии!", 'fenrir_10$;
	sleep2 3000;
	npctalk "Фенрир: Давай встретимся у входа, где мы увиделись в первый раз! Думаю, это достаточно далеко отсюда!", 'fenrir_10$;
	sleep2 3000;
	npctalk "Фенрир: Бежим!", 'fenrir_10$;
	sleep2 3000;
	cutin "",255;
	disablenpc 'fenrir_10$;
	donpcevent instance_npcname("#sarah_wrath") + "::OnStart";
	end;
}

1@glast,200,224,4	duplicate(#effect_glast_event01_1)	Фенрир#glast_10	4_F_FENRIR

// Skipped final room
1@glast,1,1,0	script	#fenrir_boss_final_2	HIDDEN_WARP_NPC,{
	end;
OnStart:
	enablenpc instance_npcname("#fenrir_boss_final_2");
	initnpctimer;
	end;
OnTimer300000:
	disablenpc instance_npcname("#glast_move_03");
	disablenpc instance_npcname("#glast_event_15");
	disablenpc 'fenrir_6$;
	end;
OnTimer305000:
	mapannounce 'map_glast$, "Фенрир: Ветер-Хранитель! Наконец-то он в моих руках!", bc_map,0xEBFF;
	end;
OnTimer308000:
	mapannounce 'map_glast$, "Сара Ирен: Хркх....", bc_map,0xEBFF;
	end;
OnTimer311000:
	mapannounce 'map_glast$, "Фенрир: Хе-хе. Ты ведь умелая воительница, однако, мне кажется, ты недооцениваешь меня, Валькирия.", bc_map,0xEBFF;
	end;
OnTimer314000:
	mapannounce 'map_glast$, "Сара Ирен: Так удиви же меня, Фенрир...", bc_map,0xEBFF;
	end;
OnTimer317000:
	mapannounce 'map_glast$, "Сара Ирен: Неужели ты думаешь, что я дам тебе так просто сбежать?", bc_map,0xEBFF;
	end;
OnTimer320000:
	mapannounce 'map_glast$, "Сара Ирен: Я превращу в ад весь Гластхейм!", bc_map,0xEBFF;
	end;
OnTimer323000:
	mapannounce 'map_glast$, "Фенрир: Если мы сейчас же не уберемся, нас ждёт незавидная судьба от её чудовищ и магии!", bc_map,0xEBFF;
	end;
OnTimer326000:
	mapannounce 'map_glast$, "Фенрир: Давай встретимся у входа, где мы увиделись в первый раз! Думаю, это достаточно далеко отсюда!", bc_map,0xEBFF;
	end;
OnTimer329000:
	stopnpctimer;
	mapannounce 'map_glast$, "Фенрир: Бежим!", bc_map,0xEBFF;
	donpcevent instance_npcname("#sarah_wrath") + "::OnStart";
	end;
OnStop:
	stopnpctimer;
	disablenpc instance_npcname("#fenrir_boss_final_2");
	end;
}

// Bombs
1@glast,1,1,0	script	#sarah_wrath	HIDDEN_WARP_NPC,{
	end;
OnStart:
	enablenpc instance_npcname("#sarah_wrath");
	enablenpc instance_npcname("#glast_move_04");
	enablenpc 'fenrir_11$;
	enablenpc 'sarah_ego$;
	hideonnpc 'sarah_ego$;
	'back_to_entrance = 1;
	enablenpc instance_npcname("#glast_move_01");
	hideonnpc instance_npcname("#glast_move_01");
	enablenpc instance_npcname("#glast_move_05");
	initnpctimer;
	end;
OnTimer10000:
	mapannounce 'map_glast$, "Сара Ирен: Мелюзга, думаешь, от меня так легко сбежать?", bc_map,0xEBFF;
	callsub S_Spawn,0;
	end;
OnTimer50000:
	mapannounce 'map_glast$, "Сара Ирен: Тебя убьют мои слуги!", bc_map,0xEBFF;
	callsub S_Spawn,1;
	end;
OnTimer80000:
	mapannounce 'map_glast$, "Сара Ирен: Тебе не уйти!", bc_map,0xEBFF;
	callsub S_Spawn,2;
	end;
OnTimer110000:
	mapannounce 'map_glast$, "Сара Ирен: Фенрир... Думаешь, если сбежишь, я тебя не выслежу?", bc_map,0xEBFF;
	callsub S_Spawn,3;
	end;
OnTimer150000:
	mapannounce 'map_glast$, "Сара Ирен: Букашка! Думаешь, от меня так просто скрыться?", bc_map,0xEBFF;
	callsub S_Spawn,4;
	end;
OnTimer300000:
	stopnpctimer;
	mapannounce 'map_glast$, "Сара Ирен: Муа-ха-ха-ха!!! Мой гнев переполнит Гластхейм!!!", bc_map,0xEBFF;
	for ( .@i = 1; .@i <= 14; .@i++ )
		enablenpc instance_npcname("#glast_bomb_" + (.@i < 10 ? ("0"+.@i) : .@i));
	end;
OnStop:
	stopnpctimer;
	end;

S_Spawn:
	// inaccurate
	switch( getarg(0) ) {
	case 0:
		monster 'map_glast$,204,52,"Гигант#aa1",3194,1;
		monster 'map_glast$,201,55,"Гигант#aa1",3194,1;
		monster 'map_glast$,196,53,"Гигант#aa1",3194,1;
		monster 'map_glast$,205,80,"Гигант#aa2",3195,1;
		monster 'map_glast$,210,77,"Гигант#aa2",3195,1;
		monster 'map_glast$,205,73,"Гигант#aa2",3195,1;
		monster 'map_glast$,236,96,"Гигант#aa5",3194,1;
		monster 'map_glast$,234,96,"Гигант#aa5",3194,1;
		monster 'map_glast$,234,96,"Гигант#aa5",3194,1;
		monster 'map_glast$,185,79,"Гигант#bb3",3194,1;
		monster 'map_glast$,189,78,"Гигант#bb3",3194,1;
		monster 'map_glast$,194,85,"Гигант#bb3",3194,1;
		monster 'map_glast$,168,113,"Гигант#bb4",3195,1;
		monster 'map_glast$,174,122,"Гигант#bb4",3195,1;
		break;
	case 1:
		monster 'map_glast$,131,182,"Гигант#bb11",3194,1;
		monster 'map_glast$,133,174,"Гигант#bb11",3194,1;
		monster 'map_glast$,134,187,"Гигант#bb11",3194,1;
		monster 'map_glast$,202,196,"Гигант#aa9",3194,1;
		monster 'map_glast$,196,194,"Гигант#aa9",3194,1;
		monster 'map_glast$,199,190,"Гигант#aa9",3194,1;
		monster 'map_glast$,233,198,"Гигант#bb8",3195,1;
		monster 'map_glast$,231,193,"Гигант#bb8",3195,1;
		monster 'map_glast$,232,196,"Гигант#bb8",3195,1;
		monster 'map_glast$,258,196,"Гигант#bb7",3194,1;
		monster 'map_glast$,265,187,"Гигант#bb7",3194,1;
		monster 'map_glast$,263,195,"Гигант#bb7",3194,1;
		monster 'map_glast$,271,106,"Гигант#aa6",3195,1;
		monster 'map_glast$,266,107,"Гигант#aa6",3195,1;
		monster 'map_glast$,272,109,"Гигант#aa6",3195,1;
		break;
	case 2:
		monster 'map_glast$,127,204,"Гигант#bb12",3195,1;
		monster 'map_glast$,130,205,"Гигант#bb12",3195,1;
		monster 'map_glast$,130,213,"Гигант#bb12",3195,1;
		monster 'map_glast$,139,243,"Гигант#bb19",3194,1;
		monster 'map_glast$,143,241,"Гигант#bb19",3194,1;
		monster 'map_glast$,146,234,"Гигант#bb19",3194,1;
		monster 'map_glast$,199,218,"Гигант#aa14",3195,1;
		monster 'map_glast$,201,219,"Гигант#aa14",3195,1;
		monster 'map_glast$,193,212,"Гигант#aa14",3195,1;
		monster 'map_glast$,261,251,"Гигант#aa18",3195,1;
		monster 'map_glast$,257,254,"Гигант#aa18",3195,1;
		monster 'map_glast$,257,250,"Гигант#aa18",3195,1;
		monster 'map_glast$,146,45,"Гигант#bb35",3194,1;
		monster 'map_glast$,145,49,"Гигант#bb35",3194,1;
		monster 'map_glast$,144,44,"Гигант#bb35",3194,1;
		break;
	case 3:
		monster 'map_glast$,67,259,"Гигант#aa29",3194,1;
		monster 'map_glast$,68,261,"Гигант#aa29",3194,1;
		monster 'map_glast$,61,260,"Гигант#aa29",3194,1;
		monster 'map_glast$,64,208,"Гигант#aa30",3195,1;
		monster 'map_glast$,67,210,"Гигант#aa30",3195,1;
		monster 'map_glast$,63,204,"Гигант#aa30",3195,1;
		monster 'map_glast$,87,57,"Гигант#aa33",3194,1;
		monster 'map_glast$,81,64,"Гигант#aa33",3194,1;
		monster 'map_glast$,83,58,"Гигант#aa33",3194,1;
		monster 'map_glast$,107,47,"Гигант#aa34",3195,1;
		monster 'map_glast$,105,45,"Гигант#aa34",3195,1;
		monster 'map_glast$,102,48,"Гигант#aa34",3195,1;
		monster 'map_glast$,80,152,"Гигант#bb31",3194,1;
		monster 'map_glast$,82,149,"Гигант#bb31",3194,1;
		monster 'map_glast$,75,156,"Гигант#bb31",3194,1;
		monster 'map_glast$,85,106,"Гигант#bb32",3195,1;
		monster 'map_glast$,82,111,"Гигант#bb32",3195,1;
		monster 'map_glast$,78,112,"Гигант#bb32",3195,1;
		monster 'map_glast$,55,149,"Гигант#bb36",3195,1;
		monster 'map_glast$,56,143,"Гигант#bb36",3195,1;
		monster 'map_glast$,49,142,"Гигант#bb36",3195,1;
		break;
	case 4:
		monster 'map_glast$,262,215,"Гигант#aa17",3194,1;
		monster 'map_glast$,266,212,"Гигант#aa17",3194,1;
		monster 'map_glast$,260,219,"Гигант#aa17",3194,1;
		monster 'map_glast$,253,47,"Гигант#aa26",3195,1;
		monster 'map_glast$,263,42,"Гигант#aa26",3195,1;
		monster 'map_glast$,255,39,"Гигант#aa26",3195,1;
		monster 'map_glast$,202,219,"Гигант#bb15",3194,1;
		monster 'map_glast$,201,222,"Гигант#bb15",3194,1;
		monster 'map_glast$,201,220,"Гигант#bb15",3194,1;
		monster 'map_glast$,231,210,"Гигант#bb16",3195,1;
		monster 'map_glast$,345,117,"Гигант#bb27",3194,1;
		monster 'map_glast$,341,115,"Гигант#bb27",3194,1;
		monster 'map_glast$,351,121,"Гигант#bb27",3194,1;
		monster 'map_glast$,346,252,"Гигант#bb28",3195,1;
		monster 'map_glast$,351,256,"Гигант#bb28",3195,1;
		monster 'map_glast$,345,254,"Гигант#bb28",3195,1;
		break;
	}
	end;
}

1@glast,290,43,0	script	#glast_bomb_01	HIDDEN_WARP_NPC,10,10,{
	end;
OnTouch:
	unitkill 0;
	mapannounce 'map_glast$, "Сара Ирен: Муа-ха-ха-ха!!! Гластхейм переполнит мой гнев!!!", bc_map,0xEBFF;
	specialeffect2 EF_LORD;
	sleep2 1000;
	specialeffect2 EF_LORD;
	end;
}

1@glast,234,47,0	duplicate(#glast_bomb_01)	#glast_bomb_02	HIDDEN_WARP_NPC,10,10
1@glast,265,175,0	duplicate(#glast_bomb_01)	#glast_bomb_03	HIDDEN_WARP_NPC,10,10
1@glast,135,176,0	duplicate(#glast_bomb_01)	#glast_bomb_04	HIDDEN_WARP_NPC,10,10
1@glast,146,238,0	duplicate(#glast_bomb_01)	#glast_bomb_05	HIDDEN_WARP_NPC,10,10
1@glast,165,212,0	duplicate(#glast_bomb_01)	#glast_bomb_06	HIDDEN_WARP_NPC,10,10
1@glast,232,212,0	duplicate(#glast_bomb_01)	#glast_bomb_07	HIDDEN_WARP_NPC,10,10
1@glast,253,241,0	duplicate(#glast_bomb_01)	#glast_bomb_08	HIDDEN_WARP_NPC,10,10
1@glast,268,290,0	duplicate(#glast_bomb_01)	#glast_bomb_09	HIDDEN_WARP_NPC,10,10
1@glast,132,289,0	duplicate(#glast_bomb_01)	#glast_bomb_10	HIDDEN_WARP_NPC,10,10
1@glast,199,115,0	duplicate(#glast_bomb_01)	#glast_bomb_11	HIDDEN_WARP_NPC,10,10
1@glast,139,46,0	duplicate(#glast_bomb_01)	#glast_bomb_12	HIDDEN_WARP_NPC,10,10
1@glast,82,86,0	duplicate(#glast_bomb_01)	#glast_bomb_13	HIDDEN_WARP_NPC,10,10
1@glast,68,226,0	duplicate(#glast_bomb_01)	#glast_bomb_14	HIDDEN_WARP_NPC,10,10

// Back to entrance
// event in #glast_move_01
1@glast,359,294,4	script	Фенрир#glast_11	4_F_FENRIR,{
	if (isbegin_quest(9337) == 0) {
		cutin "fenrir_a.bmp",2;
		mes "[Фенрир]";
		mes "А вот и ты! Ситуация довольно опасная, но ты отлично справил"+(Sex?"ся":"ась")+".";
		next;
		mes "[Фенрир]";
		mes "Чувствую, мы ещё встретимся?.. Может, мне просто кажется. Мм, хотя было бы неплохо.";
		next;
		mes "[Фенрир]";
		mes "Мы отлично поработали вместе. Надеюсь, ещё увидимся. И будь осторож"+(Sex?"ен":"на")+", Сара может попытаться навредить и тебе.";
		setquest 9337;// Wrapping up the Adventure
		getitem 607,1;// Yggdrasilberry
		getitem 608,1;// Seed_Of_Yggdrasil
		close2;
		cutin "",255;
		end;
	}
	mes "[Фенрир]";
	mes "Мы неплохо сработались.";
	mes "Надеюсь, мы встретимся вновь.";
	close;
}

1@glast,353,290,8	duplicate(#effect_glast_event01_1)	Аватар Сары Ирен	4_F_SARAH

// Shards Events
1@glast,290,147,4	script	Древнейший гигант#glast_1	4_GIGANTES_BIG,6,6,{
	end;
OnTouch:
	disablenpc instance_npcname("Древнейший гигант#glast_1");
	.@label$ = instance_npcname("Древнейший гигант#glast_1") + "::OnMobDead";
	monster 'map_glast$,290,147, "Древнейший гигант#X1",3196,1, .@label$;		// MM_L_GIGAN3
	monster 'map_glast$,290,146, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	monster 'map_glast$,288,147, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	unittalk getcharid(3), "" + strcharinfo(0) + " : Древние Гиганты, о которых говорил профессор!";
	enablenpc instance_npcname("Каменная гаргулья#glast_01");
	enablenpc instance_npcname("Каменная гаргулья#glast_02");
	enablenpc instance_npcname("Каменная гаргулья#glast_03");
	enablenpc instance_npcname("Каменная гаргулья#glast_04");
	enablenpc instance_npcname("Каменная гаргулья#glast_05");
	enablenpc instance_npcname("Каменная гаргулья#glast_06");
	end;
OnMobDead:
	end;
}

1@glast,300,248,4	script	Древнейший гигант#glast_2	4_GIGANTES_BIG,4,4,{
	end;
OnTouch:
	disablenpc instance_npcname("Древнейший гигант#glast_2");
	.@label$ = instance_npcname("Древнейший гигант#glast_2") + "::OnMobDead";
	monster 'map_glast$,300,248, "Древнейший гигант#X2",3196,1, .@label$;		// MM_L_GIGAN3
	monster 'map_glast$,299,250, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	monster 'map_glast$,302,246, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	unittalk getcharid(3), "" + strcharinfo(0) + " : Древние Гиганты, о которых говорил профессор!";
	enablenpc instance_npcname("Каменная гаргулья#glast_07");
	enablenpc instance_npcname("Каменная гаргулья#glast_08");
	enablenpc instance_npcname("Каменная гаргулья#glast_09");
	enablenpc instance_npcname("Каменная гаргулья#glast_10");
	enablenpc instance_npcname("Каменная гаргулья#glast_11");
	end;
OnMobDead:
	end;
}

1@glast,292,344,4	script	Древнейший гигант#glast_3	4_GIGANTES_BIG,6,6,{
	end;
OnTouch:
	disablenpc instance_npcname("Древнейший гигант#glast_3");
	.@label$ = instance_npcname("Древнейший гигант#glast_3") + "::OnMobDead";
	monster 'map_glast$,292,344, "Древнейший гигант#X3",3196,1, .@label$;		// MM_L_GIGAN3
	monster 'map_glast$,290,346, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	monster 'map_glast$,291,344, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	unittalk getcharid(3), "" + strcharinfo(0) + " : Древние Гиганты, о которых говорил профессор!";
	enablenpc instance_npcname("Каменная гаргулья#glast_12");
	enablenpc instance_npcname("Каменная гаргулья#glast_13");
	enablenpc instance_npcname("Каменная гаргулья#glast_14");
	end;
OnMobDead:
	end;
}

1@glast,107,147,6	script	Древнейший гигант#glast_4	4_GIGANTES_BIG,6,6,{
	end;
OnTouch:
	disablenpc instance_npcname("Древнейший гигант#glast_4");
	.@label$ = instance_npcname("Древнейший гигант#glast_4") + "::OnMobDead";
	monster 'map_glast$,107,147, "Древнейший гигант#X4",3196,1, .@label$;		// MM_L_GIGAN3
	monster 'map_glast$,107,145, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	monster 'map_glast$,106,148, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	unittalk getcharid(3), "" + strcharinfo(0) + " : Древние Гиганты, о которых говорил профессор!";
	enablenpc instance_npcname("Каменная гаргулья#glast_15");
	enablenpc instance_npcname("Каменная гаргулья#glast_16");
	enablenpc instance_npcname("Каменная гаргулья#glast_17");
	enablenpc instance_npcname("Каменная гаргулья#glast_18");
	enablenpc instance_npcname("Каменная гаргулья#glast_19");
	enablenpc instance_npcname("Каменная гаргулья#glast_20");
	end;
OnMobDead:
	end;
}

1@glast,98,248,6	script	Древнейший гигант#glast_5	4_GIGANTES_BIG,4,4,{
	end;
OnTouch:
	disablenpc instance_npcname("Древнейший гигант#glast_5");
	.@label$ = instance_npcname("Древнейший гигант#glast_5") + "::OnMobDead";
	monster 'map_glast$,98,248, "Древнейший гигант#X5",3196,1, .@label$;		// MM_L_GIGAN3
	monster 'map_glast$,96,250, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	monster 'map_glast$,98,247, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	unittalk getcharid(3), "" + strcharinfo(0) + " : Древние Гиганты, о которых говорил профессор!";
	enablenpc instance_npcname("Каменная гаргулья#glast_21");
	enablenpc instance_npcname("Каменная гаргулья#glast_22");
	enablenpc instance_npcname("Каменная гаргулья#glast_23");
	enablenpc instance_npcname("Каменная гаргулья#glast_24");
	enablenpc instance_npcname("Каменная гаргулья#glast_25");
	end;
OnMobDead:
	end;
}

1@glast,107,344,6	script	Древнейший гигант#glast_6	4_GIGANTES_BIG,6,6,{
	end;
OnTouch:
	disablenpc instance_npcname("Древнейший гигант#glast_6");
	.@label$ = instance_npcname("Древнейший гигант#glast_6") + "::OnMobDead";
	monster 'map_glast$,107,344, "Древнейший гигант#X6",3196,1, .@label$;		// MM_L_GIGAN3
	monster 'map_glast$,107,344, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	monster 'map_glast$,109,346, "Древний гигант",3193,1, .@label$;	// MM_M_GIGAN3
	unittalk getcharid(3), "" + strcharinfo(0) + " : Древние Гиганты, о которых говорил профессор!";
	enablenpc instance_npcname("Каменная гаргулья#glast_26");
	enablenpc instance_npcname("Каменная гаргулья#glast_27");
	enablenpc instance_npcname("Каменная гаргулья#glast_28");
	end;
OnMobDead:
	end;
}

1@glast,277,130,8	script	Каменная гаргулья#glast_01	4_GARGOYLE_STATUE,2,2,{
	end;
OnTouch:
	getmapxy .@map$,.@x,.@y, UNITTYPE_NPC;
	monster .@map$,.@x,.@y, "Ожившая гаргулья",3197,1, instance_npcname( strnpcinfo(0) ) + "::OnMobDead";	// MM_M_GARGOYLE
	disablenpc instance_npcname( strnpcinfo(0) );
	end;
OnMobDead:
	end;
}

1@glast,279,130,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_02	4_GARGOYLE_STATUE,2,2
1@glast,281,130,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_03	4_GARGOYLE_STATUE,2,2
1@glast,277,161,6	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_04	4_GARGOYLE_STATUE,2,2
1@glast,279,161,6	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_05	4_GARGOYLE_STATUE,2,2
1@glast,281,161,6	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_06	4_GARGOYLE_STATUE,2,2
1@glast,277,250,6	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_07	4_GARGOYLE_STATUE,2,2
1@glast,277,245,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_08	4_GARGOYLE_STATUE,2,2
1@glast,272,248,6	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_09	4_GARGOYLE_STATUE,2,2
1@glast,273,260,4	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_10	4_GARGOYLE_STATUE,2,2
1@glast,273,235,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_11	4_GARGOYLE_STATUE,2,2
1@glast,277,328,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_12	4_GARGOYLE_STATUE,2,2
1@glast,279,328,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_13	4_GARGOYLE_STATUE,2,2
1@glast,281,328,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_14	4_GARGOYLE_STATUE,2,2
1@glast,122,132,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_15	4_GARGOYLE_STATUE,2,2
1@glast,120,132,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_16	4_GARGOYLE_STATUE,2,2
1@glast,118,132,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_17	4_GARGOYLE_STATUE,2,2
1@glast,118,163,4	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_18	4_GARGOYLE_STATUE,2,2
1@glast,120,163,4	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_19	4_GARGOYLE_STATUE,2,2
1@glast,118,163,4	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_20	4_GARGOYLE_STATUE,2,2
1@glast,122,250,4	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_21	4_GARGOYLE_STATUE,2,2
1@glast,122,245,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_22	4_GARGOYLE_STATUE,2,2
1@glast,126,248,4	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_23	4_GARGOYLE_STATUE,2,2
1@glast,126,260,6	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_24	4_GARGOYLE_STATUE,2,2
1@glast,126,235,8	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_25	4_GARGOYLE_STATUE,2,2
1@glast,117,328,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_26	4_GARGOYLE_STATUE,2,2
1@glast,119,328,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_27	4_GARGOYLE_STATUE,2,2
1@glast,121,328,2	duplicate(Каменная гаргулья#glast_01)	Каменная гаргулья#glast_28	4_GARGOYLE_STATUE,2,2


1@glast,1,1,0	script	#fenrir_spawn_chimera	HIDDEN_WARP_NPC,{
	end;
OnSpawn:
	// Right side
	monster 'map_glast$,351,259,"Ужасная химера#bb28",3200,1;
	monster 'map_glast$,353,250,"Ужасная химера#bb28",3200,1;
	monster 'map_glast$,351,243,"Ужасная химера#bb28",3200,1;
	monster 'map_glast$,351,246,"Ужасная химера#bb28",3200,1;
	monster 'map_glast$,355,248,"Ужасная химера#bb28",3200,1;
	monster 'map_glast$,360,245,"Ужасная химера#bb28",3200,1;

	monster 'map_glast$,298,209,"Ужасная химера#aa14",3200,1;
	monster 'map_glast$,303,199,"Ужасная химера#aa14",3200,1;
	monster 'map_glast$,298,198,"Ужасная химера#aa14",3200,1;
	monster 'map_glast$,295,211,"Ужасная химера#aa14",3200,1;

	monster 'map_glast$,307,163,"Ужасная химера#bb15",3200,1;
	monster 'map_glast$,315,158,"Ужасная химера#bb15",3200,1;
	monster 'map_glast$,318,163,"Ужасная химера#bb15",3200,1;
	monster 'map_glast$,318,169,"Ужасная химера#bb15",3200,1;

	monster 'map_glast$,337,119,"Ужасная химера#bb27",3200,1;
	monster 'map_glast$,344,115,"Ужасная химера#bb27",3200,1;
	monster 'map_glast$,353,117,"Ужасная химера#bb27",3200,1;
	monster 'map_glast$,352,121,"Ужасная химера#bb27",3200,1;
	monster 'map_glast$,345,114,"Ужасная химера#bb27",3200,1;
	monster 'map_glast$,346,115,"Ужасная химера#bb27",3200,1;

	monster 'map_glast$,264,36,"Ужасная химера#aa26",3200,1;
	monster 'map_glast$,257,46,"Ужасная химера#aa26",3200,1;
	monster 'map_glast$,253,44,"Ужасная химера#aa26",3200,1;
	monster 'map_glast$,256,39,"Ужасная химера#aa26",3200,1;

	// Bottom, left
	monster 'map_glast$,207,46,"Ужасная химера#aa1",3200,1;
	monster 'map_glast$,197,49,"Ужасная химера#aa1",3200,1;
	monster 'map_glast$,190,52,"Ужасная химера#aa1",3200,1;
	monster 'map_glast$,200,64,"Ужасная химера#aa1",3200,1;
	monster 'map_glast$,206,76,"Ужасная химера#aa2",3200,1;
	monster 'map_glast$,207,83,"Ужасная химера#aa2",3200,1;
	monster 'map_glast$,186,82,"Ужасная химера#bb3",3200,1;
	monster 'map_glast$,200,87,"Ужасная химера#aa2",3200,1;
	monster 'map_glast$,188,86,"Ужасная химера#bb3",3200,1;
	monster 'map_glast$,215,77,"Ужасная химера#aa2",3200,1;
	monster 'map_glast$,183,90,"Ужасная химера#bb3",3200,1;
	monster 'map_glast$,192,85,"Ужасная химера#bb3",3200,1;
	monster 'map_glast$,154,36,"Ужасная химера#bb35",3200,1;
	monster 'map_glast$,150,47,"Ужасная химера#bb35",3200,1;
	monster 'map_glast$,138,52,"Ужасная химера#bb35",3200,1;
	monster 'map_glast$,152,36,"Ужасная химера#bb35",3200,1;
	monster 'map_glast$,105,50,"Ужасная химера#aa34",3200,1;
	monster 'map_glast$,100,48,"Ужасная химера#aa34",3200,1;
	monster 'map_glast$,106,52,"Ужасная химера#aa34",3200,1;
	monster 'map_glast$,82,52,"Ужасная химера#aa33",3200,1;
	monster 'map_glast$,85,51,"Ужасная химера#aa33",3200,1;
	monster 'map_glast$,80,65,"Ужасная химера#aa33",3200,1;
	monster 'map_glast$,79,58,"Ужасная химера#aa33",3200,1;
	monster 'map_glast$,82,69,"Ужасная химера#aa33",3200,1;
	monster 'map_glast$,97,41,"Ужасная химера#aa34",3200,1;
	monster 'map_glast$,86,103,"Ужасная химера#bb32",3200,1;
	monster 'map_glast$,82,102,"Ужасная химера#bb32",3200,1;
	monster 'map_glast$,78,108,"Ужасная химера#bb32",3200,1;
	monster 'map_glast$,85,109,"Ужасная химера#bb32",3200,1;
	monster 'map_glast$,82,111,"Ужасная химера#bb32",3200,1;
	monster 'map_glast$,80,144,"Ужасная химера#bb31",3200,1;
	monster 'map_glast$,72,152,"Ужасная химера#bb31",3200,1;
	monster 'map_glast$,88,159,"Ужасная химера#bb31",3200,1;
	monster 'map_glast$,73,152,"Ужасная химера#bb31",3200,1;
	monster 'map_glast$,83,160,"Ужасная химера#bb31",3200,1;
	monster 'map_glast$,77,150,"Ужасная химера#bb31",3200,1;
	monster 'map_glast$,62,207,"Ужасная химера#aa30",3200,1;
	monster 'map_glast$,70,215,"Ужасная химера#aa30",3200,1;
	monster 'map_glast$,58,209,"Ужасная химера#aa30",3200,1;
	monster 'map_glast$,68,204,"Ужасная химера#aa30",3200,1;
	monster 'map_glast$,67,214,"Ужасная химера#aa30",3200,1;
	monster 'map_glast$,58,250,"Ужасная химера#aa29",3200,1;
	monster 'map_glast$,64,257,"Ужасная химера#aa29",3200,1;
	monster 'map_glast$,70,251,"Ужасная химера#aa29",3200,1;
	monster 'map_glast$,65,247,"Ужасная химера#aa29",3200,1;
	monster 'map_glast$,65,256,"Ужасная химера#aa29",3200,1;
	monster 'map_glast$,60,255,"Ужасная химера#aa29",3200,1;
	monster 'map_glast$,50,144,"Ужасная химера#bb36",3200,1;
	monster 'map_glast$,52,143,"Ужасная химера#bb36",3200,1;
	monster 'map_glast$,54,146,"Ужасная химера#bb36",3200,1;
	monster 'map_glast$,55,140,"Ужасная химера#bb36",3200,1;

	// Left inside
	monster 'map_glast$,177,88,"Ужасная химера#bb4",3200,1;
	monster 'map_glast$,163,108,"Ужасная химера#bb4",3200,1;
	monster 'map_glast$,147,113,"Ужасная химера#bb4",3200,1;
	monster 'map_glast$,136,179,"Ужасная химера#bb11",3200,1;
	monster 'map_glast$,136,181,"Ужасная химера#bb11",3200,1;
	monster 'map_glast$,125,190,"Ужасная химера#bb11",3200,1;
	monster 'map_glast$,134,200,"Ужасная химера#bb12",3200,1;
	monster 'map_glast$,134,190,"Ужасная химера#bb11",3200,1;
	monster 'map_glast$,127,203,"Ужасная химера#bb12",3200,1;
	monster 'map_glast$,151,206,"Ужасная химера#aa13",3200,1;
	monster 'map_glast$,125,209,"Ужасная химера#bb12",3200,1;
	monster 'map_glast$,134,204,"Ужасная химера#bb12",3200,1;
	monster 'map_glast$,135,244,"Ужасная химера#bb19",3200,1;
	monster 'map_glast$,149,250,"Ужасная химера#bb19",3200,1;
	monster 'map_glast$,138,249,"Ужасная химера#bb19",3200,1;
	monster 'map_glast$,136,251,"Ужасная химера#bb19",3200,1;
	monster 'map_glast$,127,291,"Ужасная химера#bb20",3200,1;
	monster 'map_glast$,126,288,"Ужасная химера#bb20",3200,1;
	monster 'map_glast$,124,291,"Ужасная химера#bb20",3200,1;
	monster 'map_glast$,135,309,"Ужасная химера#aa21",3200,1;
	monster 'map_glast$,138,316,"Ужасная химера#aa21",3200,1;
	monster 'map_glast$,139,324,"Ужасная химера#aa22",3200,1;
	monster 'map_glast$,132,331,"Ужасная химера#aa22",3200,1;
	monster 'map_glast$,129,315,"Ужасная химера#aa21",3200,1;
	monster 'map_glast$,127,338,"Ужасная химера#aa22",3200,1;
	monster 'map_glast$,126,327,"Ужасная химера#aa22",3200,1;
	monster 'map_glast$,132,288,"Ужасная химера#bb20",3200,1;
	monster 'map_glast$,138,309,"Ужасная химера#aa21",3200,1;

	// Center and right side
	monster 'map_glast$,158,214,"Ужасная химера#aa13",3200,1;
	monster 'map_glast$,162,208,"Ужасная химера#aa13",3200,1;
	monster 'map_glast$,166,215,"Ужасная химера#aa13",3200,1;
	monster 'map_glast$,168,191,"Ужасная химера#aa10",3200,1;
	monster 'map_glast$,164,186,"Ужасная химера#aa10",3200,1;
	monster 'map_glast$,165,191,"Ужасная химера#aa10",3200,1;
	monster 'map_glast$,177,189,"Ужасная химера#aa10",3200,1;
	monster 'map_glast$,199,200,"Ужасная химера#aa9",3200,1;
	monster 'map_glast$,205,195,"Ужасная химера#aa9",3200,1;
	monster 'map_glast$,191,200,"Ужасная химера#aa9",3200,1;
	monster 'map_glast$,196,192,"Ужасная химера#aa9",3200,1;
	monster 'map_glast$,224,196,"Ужасная химера#bb8",3200,1;
	monster 'map_glast$,233,196,"Ужасная химера#bb8",3200,1;
	monster 'map_glast$,239,192,"Ужасная химера#bb8",3200,1;
	monster 'map_glast$,231,193,"Ужасная химера#bb8",3200,1;
	monster 'map_glast$,239,214,"Ужасная химера#bb16",3200,1;
	monster 'map_glast$,232,213,"Ужасная химера#bb16",3200,1;
	monster 'map_glast$,238,209,"Ужасная химера#bb16",3200,1;
	monster 'map_glast$,244,220,"Ужасная химера#bb16",3200,1;
	monster 'map_glast$,252,249,"Ужасная химера#aa18",3200,1;
	monster 'map_glast$,268,221,"Ужасная химера#aa17",3200,1;
	monster 'map_glast$,261,219,"Ужасная химера#aa17",3200,1;
	monster 'map_glast$,261,248,"Ужасная химера#aa18",3200,1;
	monster 'map_glast$,264,211,"Ужасная химера#aa17",3200,1;
	monster 'map_glast$,267,210,"Ужасная химера#aa17",3200,1;
	monster 'map_glast$,258,193,"Ужасная химера#bb7",3200,1;
	monster 'map_glast$,258,192,"Ужасная химера#bb7",3200,1;
	monster 'map_glast$,258,190,"Ужасная химера#bb7",3200,1;
	monster 'map_glast$,269,192,"Ужасная химера#bb7",3200,1;
	monster 'map_glast$,269,110,"Ужасная химера#aa6",3200,1;
	monster 'map_glast$,266,105,"Ужасная химера#aa6",3200,1;
	monster 'map_glast$,277,103,"Ужасная химера#aa6",3200,1;
	monster 'map_glast$,263,107,"Ужасная химера#aa6",3200,1;
	monster 'map_glast$,249,101,"Ужасная химера#aa5",3200,1;
	monster 'map_glast$,237,93,"Ужасная химера#aa5",3200,1;
	monster 'map_glast$,242,107,"Ужасная химера#aa5",3200,1;
	monster 'map_glast$,237,105,"Ужасная химера#aa5",3200,1;
	monster 'map_glast$,264,235,"Ужасная химера#aa18",3200,1;
	monster 'map_glast$,260,255,"Ужасная химера#aa18",3200,1;
	monster 'map_glast$,261,282,"Ужасная химера#bb23",3200,1;
	monster 'map_glast$,260,284,"Ужасная химера#bb23",3200,1;
	monster 'map_glast$,264,289,"Ужасная химера#bb23",3200,1;
	monster 'map_glast$,268,301,"Ужасная химера#bb24",3200,1;
	monster 'map_glast$,262,308,"Ужасная химера#bb24",3200,1;
	monster 'map_glast$,273,306,"Ужасная химера#bb24",3200,1;
	monster 'map_glast$,259,307,"Ужасная химера#bb24",3200,1;
	monster 'map_glast$,269,283,"Ужасная химера#bb23",3200,1;
	monster 'map_glast$,257,350,"Ужасная химера#aa25",3200,1;
	monster 'map_glast$,268,350,"Ужасная химера#aa25",3200,1;
	monster 'map_glast$,268,357,"Ужасная химера#aa25",3200,1;
	monster 'map_glast$,271,358,"Ужасная химера#aa25",3200,1;
	end;

OnInstanceInit:
	'skip_left_part = 0;
	'back_to_entrance = 0;
	'map_glast$ = instance_mapname("1@glast");
	'fenrir_1$ = instance_npcname("Фенрир#glast_01");
	'fenrir_2$ = instance_npcname("Фенрир#glast_02");
	'fenrir_3$ = instance_npcname("Фенрир#glast_03");
	'fenrir_4$ = instance_npcname("Фенрир#glast_04");
	'fenrir_5$ = instance_npcname("Фенрир#glast_05");
	'fenrir_6$ = instance_npcname("Фенрир#glast_06");
	'fenrir_7$ = instance_npcname("Фенрир#glast_07");
	'fenrir_8$ = instance_npcname("Фенрир#glast_08");
	'fenrir_9$ = instance_npcname("Фенрир#glast_09");
	'fenrir_10$ = instance_npcname("Фенрир#glast_10");
	'fenrir_11$ = instance_npcname("Фенрир#glast_11");
	'sarah_10$ = instance_npcname("Сара Ирен#glast_10");
	'sarah_17$ = instance_npcname("Сара Ирен#glast_17");
	'sarah_20$ = instance_npcname("Сара Ирен#glast_20");
	'sarah_ego$ = instance_npcname("Аватар Сары Ирен");

	// Entrance
	disablenpc instance_npcname("#glast_event_3");
	for ( .@i = 1; .@i < 8; .@i++ )
		hideonnpc instance_npcname("#effect_glast_event01_" + .@i);
	disablenpc instance_npcname("#glast_move_01");

	// Fenrir bottom
	disablenpc instance_npcname("#glast_event_5");
	disablenpc 'fenrir_2$;

	// Fenrir left side, entrance
	disablenpc instance_npcname("#glast_event_7");
	disablenpc 'fenrir_3$;

	// Fenrir left side, inside
	disablenpc 'fenrir_4$;
	disablenpc 'sarah_10$;
	disablenpc instance_npcname("Гигант#semi1");
	disablenpc instance_npcname("Гигант#semi2");
	disablenpc instance_npcname("#glast_event_9");
	for ( .@i = 1; .@i < 9; .@i++ )
		hideonnpc instance_npcname("#effect_glast_event02_" + .@i);
	hideonnpc instance_npcname("#effect_glast_event02_bis");
	//for ( .@i = 1; .@i < 8; .@i++ )
	//	disablenpc instance_npcname("#glast_event_warp_" + .@i);
	disablenpc instance_npcname("#fenrir_left_vermilion");
	disablenpc instance_npcname("#fenrir_left_final_1");

	// Event top side
	disablenpc instance_npcname("#glast_event_13");
	disablenpc 'fenrir_5$;

	// Skipped left side
	disablenpc instance_npcname("#fenrir_left_final_2");

	// Stairs final room
	disablenpc instance_npcname("#glast_move_03");
	disablenpc instance_npcname("#glast_event_15");
	disablenpc 'fenrir_6$;

	// Final room
	disablenpc instance_npcname("#glast_move_03a");
	disablenpc instance_npcname("#glast_event_18");
	disablenpc instance_npcname("Сара Ирен#glast_17");
	disablenpc 'sarah_20$;
	disablenpc 'fenrir_7$;
	disablenpc 'fenrir_8$;
	disablenpc 'fenrir_9$;
	//for ( .@i = 11; .@i <= 16; .@i++ )
	//	disablenpc instance_npcname("#glast_event_warp_" + .@i);
	for ( .@i = 1; .@i <= 8; .@i++ )
		hideonnpc instance_npcname("#effect_glast_event03_" + .@i);
	disablenpc instance_npcname("#glast_event_19");
	disablenpc instance_npcname("#fenrir_boss_final_1");

	// Outside final room
	disablenpc instance_npcname("#glast_event_24");
	disablenpc 'fenrir_10$;

	// Skipped final room
	disablenpc instance_npcname("#fenrir_boss_final_2");

	// Bombs
	disablenpc instance_npcname("#sarah_wrath");
	for ( .@i = 1; .@i <= 14; .@i++ )
		disablenpc instance_npcname("#glast_bomb_" + (.@i < 10 ? ("0"+.@i) : .@i));

	// Back to entrance
	disablenpc instance_npcname("Аватар Сары Ирен");
	disablenpc 'fenrir_11$;
	disablenpc instance_npcname("#glast_move_04");
	disablenpc instance_npcname("#glast_move_05");

	// Shards
	for ( .@i = 1; .@i < 7; .@i++ )
		disablenpc instance_npcname("Древнейший гигант#glast_" + .@i);
	for ( .@i = 1; .@i < 29; .@i++ )
		disablenpc instance_npcname( "Каменная гаргулья#glast_" + (.@i < 10 ? ("0"+.@i) : .@i) );

	// Spawn chimera
	donpcevent instance_npcname("#fenrir_spawn_chimera") + "::OnSpawn";
	end;
}
